[{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\actions\\admin.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":133,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4130,4133],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4130,4133],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use server\";\r\n\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport { cookies } from \"next/headers\";\r\n\r\n// Helper to verify the current user is admin\r\nasync function requireAdmin() {\r\n    const cookieStore = await cookies();\r\n    const userId = cookieStore.get(\"userId\")?.value;\r\n    if (!userId) throw new Error(\"Nie zalogowano\");\r\n\r\n    const user = await prisma.user.findUnique({\r\n        where: { id: userId },\r\n        select: { isAdmin: true },\r\n    });\r\n\r\n    if (!user?.isAdmin) throw new Error(\"Brak uprawnie┼ä administratora\");\r\n    return true;\r\n}\r\n\r\nexport async function getTeams() {\r\n    return prisma.team.findMany({\r\n        orderBy: { name: \"asc\" },\r\n        include: { drivers: { orderBy: { number: \"asc\" } } },\r\n    });\r\n}\r\n\r\nexport async function getDrivers() {\r\n    return prisma.driver.findMany({\r\n        orderBy: { name: \"asc\" },\r\n        include: { team: { select: { name: true } } },\r\n    });\r\n}\r\n\r\nexport async function addDriver(formData: FormData) {\r\n    await requireAdmin();\r\n\r\n    const slug = formData.get(\"slug\") as string;\r\n    const name = formData.get(\"name\") as string;\r\n    const number = parseInt(formData.get(\"number\") as string, 10);\r\n    const country = formData.get(\"country\") as string;\r\n    const teamId = formData.get(\"teamId\") as string;\r\n    const color = formData.get(\"color\") as string;\r\n    const active = formData.get(\"active\") === \"true\";\r\n\r\n    if (!slug || !name || !number || !teamId) {\r\n        return { error: \"Brakuje wymaganych p├│l (slug, name, number, teamId)\" };\r\n    }\r\n\r\n    // Check if slug already exists\r\n    const existing = await prisma.driver.findUnique({ where: { slug } });\r\n    if (existing) {\r\n        return { error: `Kierowca o slug \"${slug}\" ju┼╝ istnieje` };\r\n    }\r\n\r\n    const driver = await prisma.driver.create({\r\n        data: { slug, name, number, country: country || null, teamId, color: color || null, active },\r\n        include: { team: { select: { name: true } } },\r\n    });\r\n\r\n    return { success: true, driver };\r\n}\r\n\r\nexport async function updateDriver(formData: FormData) {\r\n    await requireAdmin();\r\n\r\n    const slug = formData.get(\"slug\") as string;\r\n    const name = formData.get(\"name\") as string;\r\n    const number = parseInt(formData.get(\"number\") as string, 10);\r\n    const country = formData.get(\"country\") as string;\r\n    const teamId = formData.get(\"teamId\") as string;\r\n    const color = formData.get(\"color\") as string;\r\n    const active = formData.get(\"active\") === \"true\";\r\n\r\n    if (!slug || !name || !number || !teamId) {\r\n        return { error: \"Brakuje wymaganych p├│l\" };\r\n    }\r\n\r\n    const driver = await prisma.driver.update({\r\n        where: { slug },\r\n        data: { name, number, country: country || null, teamId, color: color || null, active },\r\n        include: { team: { select: { name: true } } },\r\n    });\r\n\r\n    return { success: true, driver };\r\n}\r\n\r\nexport async function deleteDriver(slug: string) {\r\n    await requireAdmin();\r\n\r\n    // Delete related votes first\r\n    await prisma.vote.deleteMany({ where: { driverId: slug } });\r\n    // Remove favorite references\r\n    await prisma.user.updateMany({\r\n        where: { favoriteDriverId: slug },\r\n        data: { favoriteDriverId: null },\r\n    });\r\n\r\n    await prisma.driver.delete({ where: { slug } });\r\n\r\n    return { success: true };\r\n}\r\n\r\nexport async function getAllUsersWithVotes() {\r\n    await requireAdmin();\r\n\r\n    const users = await prisma.user.findMany({\r\n        orderBy: { name: \"asc\" },\r\n        include: {\r\n            votes: true,\r\n            seasonVotes: true,\r\n            team: { select: { name: true } },\r\n        }\r\n    });\r\n\r\n    return users.map(u => ({\r\n        id: u.id,\r\n        name: u.name,\r\n        username: u.username,\r\n        isAdmin: u.isAdmin,\r\n        team: u.team?.name || \"Brak\",\r\n        votesCount: u.votes.length,\r\n        seasonVotesCount: u.seasonVotes.length,\r\n        createdAt: u.createdAt\r\n    }));\r\n}\r\n\r\nexport async function deleteUser(userId: string) {\r\n    await requireAdmin();\r\n    try {\r\n        await prisma.user.delete({ where: { id: userId } });\r\n        return { success: true };\r\n    } catch (e: any) {\r\n        return { error: e.message || \"B┼é─àd usuwania u┼╝ytkownika\" };\r\n    }\r\n}\r\n\r\nexport async function getUserDetails(userId: string) {\r\n    await requireAdmin();\r\n    \r\n    // Fetch user with extended vote data\r\n    const user = await prisma.user.findUnique({\r\n        where: { id: userId },\r\n        include: {\r\n            seasonVotes: {\r\n                orderBy: { position: \"asc\" },\r\n                include: {\r\n                    driver: { select: { slug: true, name: true, team: { select: { name: true } } } }\r\n                }\r\n            },\r\n            votes: {\r\n                orderBy: { createdAt: \"desc\" },\r\n                include: {\r\n                    driver: { select: { slug: true, name: true } }\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    if (!user) return { error: \"Nie znaleziono u┼╝ytkownika\" };\r\n\r\n    return {\r\n        user: {\r\n            id: user.id,\r\n            name: user.name,\r\n            username: user.username,\r\n            seasonVotes: user.seasonVotes.map(v => ({\r\n                position: v.position,\r\n                driver: v.driver.name,\r\n                team: v.driver.team.name\r\n            })),\r\n            raceVotes: user.votes.map(v => ({\r\n                raceRound: v.raceRound,\r\n                driver: v.driver.name,\r\n                createdAt: v.createdAt\r\n            }))\r\n        }\r\n    };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\actions\\auth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\actions\\leaderboard.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\actions\\profile.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\actions\\races.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SeedRace' is defined but never used.","line":4,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":45,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"SeedRace"},"fix":{"range":[83,101],"text":""},"desc":"Remove unused variable \"SeedRace\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":46,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1474,1477],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1474,1477],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":87,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":87,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2803,2806],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2803,2806],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":124,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":124,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4059,4062],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4059,4062],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":137,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":137,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4436,4439],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4436,4439],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use server\";\r\n\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport { races as seedData, Race as SeedRace } from \"@/lib/data\";\r\nimport { cookies } from \"next/headers\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\n// Admin check helper\r\nasync function requireAdmin() {\r\n    const cookieStore = await cookies();\r\n    const userId = cookieStore.get(\"userId\")?.value;\r\n    if (!userId) throw new Error(\"Nie zalogowano\");\r\n\r\n    const user = await prisma.user.findUnique({\r\n        where: { id: userId },\r\n        select: { isAdmin: true },\r\n    });\r\n\r\n    if (!user?.isAdmin) throw new Error(\"Brak uprawnie┼ä administratora\");\r\n    return true;\r\n}\r\n\r\nexport async function seedRaces() {\r\n    await requireAdmin();\r\n    try {\r\n        for (const race of seedData) {\r\n            await prisma.race.upsert({\r\n                where: { round: race.round },\r\n                update: {\r\n                    name: race.name,\r\n                    location: race.location,\r\n                    date: new Date(race.date),\r\n                    isTesting: race.isTesting || false,\r\n                },\r\n                create: {\r\n                    round: race.round,\r\n                    name: race.name,\r\n                    location: race.location,\r\n                    date: new Date(race.date),\r\n                    isTesting: race.isTesting || false,\r\n                },\r\n            });\r\n        }\r\n        revalidatePath(\"/admin\");\r\n        return { success: true };\r\n    } catch (e: any) {\r\n        return { error: e.message || \"B┼é─àd seedowania wy┼øcig├│w\" };\r\n    }\r\n}\r\n\r\nexport async function getRaces() {\r\n    return prisma.race.findMany({\r\n        orderBy: { round: \"asc\" },\r\n    });\r\n}\r\n\r\nexport async function addRace(formData: FormData) {\r\n    await requireAdmin();\r\n\r\n    const round = parseInt(formData.get(\"round\") as string);\r\n    const name = formData.get(\"name\") as string;\r\n    const location = formData.get(\"location\") as string;\r\n    const date = formData.get(\"date\") as string;\r\n    const trackImage = formData.get(\"trackImage\") as string;\r\n    const country = formData.get(\"country\") as string;\r\n    const circuitId = formData.get(\"circuitId\") as string;\r\n\r\n    if (!round || !name || !location || !date) {\r\n        return { error: \"Brakuje wymaganych p├│l (Runda, Nazwa, Lokalizacja, Data)\" };\r\n    }\r\n\r\n    try {\r\n        const race = await prisma.race.create({\r\n            data: {\r\n                round,\r\n                name,\r\n                location,\r\n                date: new Date(date),\r\n                trackImage: trackImage || null,\r\n                country: country || null,\r\n                circuitId: circuitId || null,\r\n            },\r\n        });\r\n        revalidatePath(\"/admin\");\r\n        revalidatePath(\"/calendar\");\r\n        return { success: true, race };\r\n    } catch (e: any) {\r\n        return { error: e.message || \"B┼é─àd dodawania wy┼øcigu\" };\r\n    }\r\n}\r\n\r\nexport async function updateRace(formData: FormData) {\r\n    await requireAdmin();\r\n\r\n    const id = formData.get(\"id\") as string;\r\n    const round = parseInt(formData.get(\"round\") as string);\r\n    const name = formData.get(\"name\") as string;\r\n    const location = formData.get(\"location\") as string;\r\n    const date = formData.get(\"date\") as string;\r\n    const trackImage = formData.get(\"trackImage\") as string;\r\n    const country = formData.get(\"country\") as string;\r\n    const circuitId = formData.get(\"circuitId\") as string;\r\n\r\n    if (!id || !round || !name || !location || !date) {\r\n        return { error: \"Brakuje wymaganych p├│l\" };\r\n    }\r\n\r\n    try {\r\n        const race = await prisma.race.update({\r\n            where: { id },\r\n            data: {\r\n                round,\r\n                name,\r\n                location,\r\n                date: new Date(date),\r\n                trackImage: trackImage || null,\r\n                country: country || null,\r\n                circuitId: circuitId || null,\r\n            },\r\n        });\r\n        revalidatePath(\"/admin\");\r\n        revalidatePath(\"/calendar\");\r\n        return { success: true, race };\r\n    } catch (e: any) {\r\n        return { error: e.message || \"B┼é─àd aktualizacji wy┼øcigu\" };\r\n    }\r\n}\r\n\r\nexport async function deleteRace(id: string) {\r\n    await requireAdmin();\r\n    try {\r\n        await prisma.race.delete({ where: { id } });\r\n        revalidatePath(\"/admin\");\r\n        revalidatePath(\"/calendar\");\r\n        return { success: true };\r\n// ...existing code...\r\n    } catch (e: any) {\r\n        return { error: e.message || \"B┼é─àd usuwania wy┼øcigu\" };\r\n    }\r\n}\r\n\r\nexport async function getNextRound() {\r\n    const races = await prisma.race.findMany({\r\n        orderBy: { round: \"asc\" },\r\n        select: { round: true, date: true }\r\n    });\r\n    const now = new Date();\r\n    const nextRace = races.find(r => r.date > now);\r\n    return nextRace?.round || races[races.length - 1]?.round || 1;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\actions\\seasonVote.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\admin\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Users' is defined but never used.","line":10,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":47,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Users"},"fix":{"range":[524,531],"text":""},"desc":"Remove unused variable \"Users\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":128,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":128,"endColumn":21},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":213,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":213,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7172,7175],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7172,7175],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":230,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":230,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":280,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":280,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9343,9346],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9343,9346],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":296,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":296,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9882,9885],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9882,9885],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":318,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":318,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10764,10767],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10764,10767],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":320,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":320,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":339,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":339,"endColumn":20},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":587,"column":49,"nodeType":"JSXOpeningElement","endLine":587,"endColumn":142}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useAuth } from \"@/app/providers/AuthProvider\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { getTeamLogo } from \"@/lib/data\";\r\nimport { getTeams, getDrivers, addDriver, updateDriver, deleteDriver, getAllUsersWithVotes, deleteUser, getUserDetails } from \"@/app/actions/admin\";\r\nimport { getRaces, addRace, updateRace, deleteRace, seedRaces } from \"@/app/actions/races\";\r\nimport { toast } from \"sonner\";\r\nimport { Plus, Trash2, Edit3, X, Shield, Users, ChevronDown, Trophy, Flag, LogOut } from \"lucide-react\";\r\nimport { logoutUser } from \"@/app/actions/auth\";\r\nimport { clsx } from \"clsx\";\r\nimport ReactCountryFlag from \"react-country-flag\";\r\n\r\n\r\ntype Team = {\r\n    id: string;\r\n    name: string;\r\n    color: string | null;\r\n    drivers: { slug: string; name: string; number: number; country: string | null; color: string | null }[];\r\n};\r\n\r\ntype DriverRow = {\r\n    slug: string;\r\n    name: string;\r\n    number: number;\r\n    country: string | null;\r\n    color: string | null;\r\n    active?: boolean;\r\n    teamId: string;\r\n    team: { name: string };\r\n};\r\n\r\ntype UserRow = {\r\n    id: string;\r\n    name: string | null;\r\n    username: string;\r\n    isAdmin: boolean;\r\n    team: string;\r\n    votesCount: number;\r\n    seasonVotesCount: number;\r\n    createdAt: Date;\r\n};\r\n\r\ntype UserDetails = {\r\n    id: string;\r\n    name: string | null;\r\n    username: string;\r\n    seasonVotes: { position: number; driver: string; team: string }[];\r\n    raceVotes: { raceRound: string; driver: string; createdAt: Date }[];\r\n};\r\n\r\ntype Race = {\r\n    id: string;\r\n    round: number;\r\n    name: string;\r\n    location: string;\r\n    date: string | Date; // Can be string depending on serialization/parsing\r\n    trackImage: string | null;\r\n    country: string | null;\r\n    circuitId: string | null;\r\n};\r\n\r\nexport default function AdminPage() {\r\n    const { user, loading } = useAuth();\r\n    const router = useRouter();\r\n    \r\n    // Data\r\n    const [teams, setTeams] = useState<Team[]>([]);\r\n    const [drivers, setDrivers] = useState<DriverRow[]>([]);\r\n    const [users, setUsers] = useState<UserRow[]>([]);\r\n    const [races, setRaces] = useState<Race[]>([]);\r\n    \r\n    // UI State\r\n    const [activeTab, setActiveTab] = useState<\"drivers\" | \"users\" | \"races\">(\"drivers\");\r\n    const [showForm, setShowForm] = useState(false);\r\n    const [editingSlug, setEditingSlug] = useState<string | null>(null);\r\n    const [formLoading, setFormLoading] = useState(false);\r\n    const [dataLoading, setDataLoading] = useState(true);\r\n\r\n    // Form state (Drivers)\r\n    const [formSlug, setFormSlug] = useState(\"\");\r\n    const [formName, setFormName] = useState(\"\");\r\n    const [formNumber, setFormNumber] = useState(\"\");\r\n    const [formCountry, setFormCountry] = useState(\"\");\r\n    const [formTeamId, setFormTeamId] = useState(\"\");\r\n    const [formColor, setFormColor] = useState(\"\");\r\n    const [formActive, setFormActive] = useState(true);\r\n\r\n    // Form state (Races)\r\n    const [formRaceId, setFormRaceId] = useState<string | null>(null);\r\n    const [formRaceRound, setFormRaceRound] = useState(\"\");\r\n    const [formRaceName, setFormRaceName] = useState(\"\");\r\n    const [formRaceLocation, setFormRaceLocation] = useState(\"\");\r\n    const [formRaceDate, setFormRaceDate] = useState(\"\");\r\n    const [formRaceTrackImage, setFormRaceTrackImage] = useState(\"\");\r\n    const [formRaceCountry, setFormRaceCountry] = useState(\"\");\r\n\r\n    // User details state\r\n    const [selectedUser, setSelectedUser] = useState<UserDetails | null>(null);\r\n    const [detailsLoading, setDetailsLoading] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (!loading && (!user || !user.isAdmin)) {\r\n            router.replace(\"/calendar\");\r\n        }\r\n    }, [user, loading, router]);\r\n\r\n    useEffect(() => {\r\n        if (user?.isAdmin) {\r\n            loadData();\r\n        }\r\n    }, [user]);\r\n\r\n    async function loadData() {\r\n        setDataLoading(true);\r\n        try {\r\n            const [teamsData, driversData, usersData, racesData] = await Promise.all([\r\n                getTeams(), \r\n                getDrivers(),\r\n                getAllUsersWithVotes(),\r\n                getRaces()\r\n            ]);\r\n            setTeams(teamsData as Team[]);\r\n            setDrivers(driversData as DriverRow[]);\r\n            setUsers(usersData as UserRow[]);\r\n            setRaces(racesData as unknown as Race[]);\r\n        } catch (err) {\r\n            toast.error(\"Nie uda┼éo si─Ö za┼éadowa─ç danych\");\r\n        } finally {\r\n            setDataLoading(false);\r\n        }\r\n    }\r\n\r\n    function resetForm() {\r\n        // Driver form reset\r\n        setFormSlug(\"\");\r\n        setFormName(\"\");\r\n        setFormNumber(\"\");\r\n        setFormCountry(\"\");\r\n        setFormTeamId(\"\");\r\n        setFormColor(\"\");\r\n        setFormActive(true);\r\n        setEditingSlug(null);\r\n        \r\n        // Race form reset\r\n        setFormRaceId(null);\r\n        setFormRaceRound(\"\");\r\n        setFormRaceName(\"\");\r\n        setFormRaceLocation(\"\");\r\n        setFormRaceDate(\"\");\r\n        setFormRaceTrackImage(\"\");\r\n        setFormRaceCountry(\"\");\r\n\r\n        setShowForm(false);\r\n    }\r\n\r\n    function openEditForm(driver: DriverRow) {\r\n        setFormSlug(driver.slug);\r\n        setFormName(driver.name);\r\n        setFormNumber(String(driver.number));\r\n        setFormCountry(driver.country || \"\");\r\n        setFormTeamId(driver.teamId);\r\n        setFormColor(driver.color || \"\");\r\n        setFormActive(driver.active ?? true);\r\n        setEditingSlug(driver.slug);\r\n        setShowForm(true);\r\n    }\r\n\r\n    function openRaceForm(race?: Race) {\r\n        resetForm();\r\n        if (race) {\r\n            setFormRaceId(race.id);\r\n            setFormRaceRound(String(race.round));\r\n            setFormRaceName(race.name);\r\n            setFormRaceLocation(race.location);\r\n            setFormRaceDate(new Date(race.date).toISOString().slice(0, 16)); // for datetime-local\r\n            setFormRaceTrackImage(race.trackImage || \"\");\r\n            setFormRaceCountry(race.country || \"\");\r\n        }\r\n        setShowForm(true);\r\n    }\r\n\r\n    async function handleRaceSubmit(e: React.FormEvent) {\r\n        e.preventDefault();\r\n        setFormLoading(true);\r\n\r\n        try {\r\n            const formData = new FormData();\r\n            formData.append(\"round\", formRaceRound);\r\n            formData.append(\"name\", formRaceName);\r\n            formData.append(\"location\", formRaceLocation);\r\n            formData.append(\"date\", formRaceDate);\r\n            formData.append(\"trackImage\", formRaceTrackImage);\r\n            formData.append(\"country\", formRaceCountry);\r\n\r\n            let result;\r\n            if (formRaceId) {\r\n                formData.append(\"id\", formRaceId);\r\n                result = await updateRace(formData);\r\n            } else {\r\n                result = await addRace(formData);\r\n            }\r\n\r\n            if (result.error) {\r\n                toast.error(result.error);\r\n                return;\r\n            }\r\n\r\n            toast.success(formRaceId ? \"Wy┼øcig zaktualizowany\" : \"Wy┼øcig dodany\");\r\n            resetForm();\r\n            await loadData();\r\n        } catch (e: any) {\r\n            toast.error(e.message || \"B┼é─àd zapisu\");\r\n        } finally {\r\n            setFormLoading(false);\r\n        }\r\n    }\r\n\r\n    async function handleDeleteRace(id: string, name: string) {\r\n        if (!confirm(`Usun─à─ç wy┼øcig ${name}?`)) return;\r\n        try {\r\n            const result = await deleteRace(id);\r\n            if (result.success) {\r\n                toast.success(\"Usuni─Öto wy┼øcig\");\r\n                await loadData();\r\n            } else {\r\n                toast.error(result.error);\r\n            }\r\n        } catch (e) {\r\n            toast.error(\"B┼é─àd usuwania\");\r\n        }\r\n    }\r\n\r\n    async function handleSeedRaces() {\r\n        if (!confirm(\"Zaimportowa─ç wy┼øcigi z pliku data.ts? To mo┼╝e nadpisa─ç istniej─àce.\")) return;\r\n        setFormLoading(true);\r\n        try {\r\n            const result = await seedRaces();\r\n            if (result.success) {\r\n                toast.success(\"Zaimportowano wy┼øcigi\");\r\n                await loadData();\r\n            } else {\r\n                toast.error(result.error);\r\n            }\r\n        } finally {\r\n            setFormLoading(false);\r\n        }\r\n    }\r\n\r\n    async function handleSubmit(e: React.FormEvent) {\r\n        e.preventDefault();\r\n        setFormLoading(true);\r\n\r\n        try {\r\n            const formData = new FormData();\r\n            formData.append(\"slug\", formSlug);\r\n            formData.append(\"name\", formName);\r\n            formData.append(\"number\", formNumber);\r\n            formData.append(\"country\", formCountry);\r\n            formData.append(\"teamId\", formTeamId);\r\n            formData.append(\"color\", formColor);\r\n            formData.append(\"active\", String(formActive));\r\n\r\n            let result;\r\n            if (editingSlug) {\r\n                result = await updateDriver(formData);\r\n            } else {\r\n                result = await addDriver(formData);\r\n            }\r\n\r\n            if (result.error) {\r\n                toast.error(result.error);\r\n                return;\r\n            }\r\n\r\n            toast.success(editingSlug ? \"Kierowca zaktualizowany!\" : \"Kierowca dodany!\");\r\n            resetForm();\r\n            await loadData();\r\n        } catch (err: any) {\r\n            toast.error(err.message || \"Wyst─àpi┼é b┼é─àd\");\r\n        } finally {\r\n            setFormLoading(false);\r\n        }\r\n    }\r\n\r\n    async function handleDelete(slug: string, name: string) {\r\n        if (!confirm(`Usun─à─ç kierowc─Ö ${name}? Wszystkie powi─àzane g┼éosy zostan─à usuni─Öte.`)) return;\r\n\r\n        try {\r\n            const result = await deleteDriver(slug);\r\n            if (result.success) {\r\n                toast.success(`Usuni─Öto ${name}`);\r\n                await loadData();\r\n            }\r\n        } catch (err: any) {\r\n            toast.error(err.message || \"Nie uda┼éo si─Ö usun─à─ç\");\r\n        }\r\n    }\r\n\r\n    async function handleUserClick(userId: string) {\r\n        setDetailsLoading(true);\r\n        setSelectedUser(null);\r\n        // Show modal immediately/loading state\r\n        setShowForm(false); // Close other forms if open\r\n        \r\n        // We need to set some state to show modal, maybe reuse showForm or a new one?\r\n        // Using selectedUser !== null as trigger for modal.\r\n        // But we need to load first. \r\n        // Let's rely on detailsLoading to show a spinner in modal if we open it immediately?\r\n        // Or just wait. Let's wait.\r\n        \r\n        try {\r\n            const result = await getUserDetails(userId);\r\n            if (result.error) {\r\n                toast.error(result.error);\r\n            } else {\r\n                setSelectedUser(result.user as any); // Cast because of Date serialization over wire potentially\r\n            }\r\n        } catch (e) {\r\n            toast.error(\"B┼é─àd pobierania szczeg├│┼é├│w\");\r\n        } finally {\r\n            setDetailsLoading(false);\r\n        }\r\n    }\r\n\r\n    async function handleDeleteUser(userId: string, username: string, e: React.MouseEvent) {\r\n         e.stopPropagation();\r\n         if (!confirm(`Usun─à─ç u┼╝ytkownika @${username}? Ta operacja jest nieodwracalna.`)) return;\r\n         try {\r\n             const result = await deleteUser(userId);\r\n             if (result.success) {\r\n                 toast.success(`Usuni─Öto u┼╝ytkownika @${username}`);\r\n                 await loadData();\r\n                 if (selectedUser?.id === userId) setSelectedUser(null);\r\n             } else {\r\n                 toast.error(result.error);\r\n             }\r\n         } catch (e) {\r\n             toast.error(\"B┼é─àd usuwania\");\r\n         }\r\n    }\r\n\r\n    if (loading || !user?.isAdmin) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-[50vh]\">\r\n                <div className=\"animate-spin rounded-full h-8 w-8 border-t-2 border-[#E60000]\"></div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"pb-32 pt-8 px-4\">\r\n            {/* Header */}\r\n            <div className=\"flex items-center justify-between mb-8\">\r\n                <div className=\"flex items-center gap-3\">\r\n                    <div className=\"bg-[#E60000] p-2.5 rounded-xl\">\r\n                        <Shield className=\"w-6 h-6 text-white\" />\r\n                    </div>\r\n                    <div>\r\n                        <h1 className=\"text-3xl font-black text-white uppercase tracking-tighter\">\r\n                            Panel <span className=\"text-[#E60000]\">Admina</span>\r\n                        </h1>\r\n                        <p className=\"text-gray-500 text-xs font-bold uppercase tracking-widest\">\r\n                            Zarz─àdzanie\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n                <button \r\n                    onClick={() => logoutUser()}\r\n                    className=\"p-3 bg-[#1C1C1E] hover:bg-red-900/20 border border-white/10 hover:border-red-900/40 rounded-xl transition-all group\"\r\n                    title=\"Wyloguj si─Ö\"\r\n                >\r\n                    <LogOut className=\"w-5 h-5 text-gray-500 group-hover:text-[#E60000] transition-colors\" />\r\n                </button>\r\n            </div>\r\n\r\n            {/* Stats cards */}\r\n            <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3 mb-8\">\r\n                <div className=\"bg-[#1C1C1E] border border-white/5 rounded-2xl p-5\">\r\n                    <div className=\"text-gray-500 text-[10px] uppercase font-bold tracking-widest mb-1\">Kierowcy</div>\r\n                    <div className=\"text-3xl font-black text-white\">{drivers.length}</div>\r\n                </div>\r\n                <div className=\"bg-[#1C1C1E] border border-white/5 rounded-2xl p-5\">\r\n                    <div className=\"text-gray-500 text-[10px] uppercase font-bold tracking-widest mb-1\">U┼╝ytkownicy</div>\r\n                    <div className=\"text-3xl font-black text-white\">{users.length}</div>\r\n                </div>\r\n                <div className=\"bg-[#1C1C1E] border border-white/5 rounded-2xl p-5 hidden md:block\">\r\n                    <div className=\"text-gray-500 text-[10px] uppercase font-bold tracking-widest mb-1\">G┼éosy</div>\r\n                    <div className=\"text-3xl font-black text-white\">\r\n                        {users.reduce((acc, u) => acc + u.votesCount + u.seasonVotesCount, 0)}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Tabs */}\r\n            <div className=\"flex p-1 bg-[#1C1C1E] rounded-xl mb-6 border border-white/5 w-full md:w-auto self-start inline-flex\">\r\n                <button\r\n                    onClick={() => setActiveTab(\"drivers\")}\r\n                    className={clsx(\r\n                        \"flex-1 md:flex-none px-6 py-2 rounded-lg text-sm font-bold transition-all\",\r\n                        activeTab === \"drivers\" ? \"bg-[#2C2C2E] text-white shadow\" : \"text-gray-500 hover:text-gray-300\"\r\n                    )}\r\n                >\r\n                    Kierowcy\r\n                </button>\r\n                <button\r\n                    onClick={() => setActiveTab(\"users\")}\r\n                    className={clsx(\r\n                        \"flex-1 md:flex-none px-6 py-2 rounded-lg text-sm font-bold transition-all\",\r\n                        activeTab === \"users\" ? \"bg-[#2C2C2E] text-white shadow\" : \"text-gray-500 hover:text-gray-300\"\r\n                    )}\r\n                >\r\n                    U┼╝ytkownicy\r\n                </button>\r\n                <button\r\n                    onClick={() => setActiveTab(\"races\")}\r\n                    className={clsx(\r\n                        \"flex-1 md:flex-none px-6 py-2 rounded-lg text-sm font-bold transition-all\",\r\n                        activeTab === \"races\" ? \"bg-[#2C2C2E] text-white shadow\" : \"text-gray-500 hover:text-gray-300\"\r\n                    )}\r\n                >\r\n                    Wy┼øcigi\r\n                </button>\r\n            </div>\r\n\r\n            {/* Content Content - Drivers */}\r\n            {activeTab === \"drivers\" && (\r\n                <>\r\n                    <button\r\n                        onClick={() => { resetForm(); setShowForm(true); }}\r\n                        className=\"w-full flex items-center justify-center gap-3 p-4 bg-[#E60000] hover:bg-red-700 rounded-2xl font-black uppercase tracking-wider text-white transition-all active:scale-[0.98] mb-8 shadow-lg shadow-red-900/20\"\r\n                    >\r\n                        <Plus className=\"w-5 h-5\" />\r\n                        Dodaj Kierowc─Ö\r\n                    </button>\r\n\r\n                    {showForm && (\r\n                        <div className=\"fixed inset-0 bg-black/70 backdrop-blur-sm z-[70] flex items-center justify-center p-4\">\r\n                            <div className=\"bg-[#1C1C1E] border border-white/10 rounded-3xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto\">\r\n                                <div className=\"flex items-center justify-between mb-6\">\r\n                                    <h2 className=\"text-xl font-black text-white uppercase tracking-tight\">\r\n                                        {editingSlug ? \"Edytuj\" : \"Nowy\"} <span className=\"text-[#E60000]\">Kierowca</span>\r\n                                    </h2>\r\n                                    <button onClick={resetForm} className=\"p-2 hover:bg-white/10 rounded-xl transition-colors\">\r\n                                        <X className=\"w-5 h-5 text-gray-400\" />\r\n                                    </button>\r\n                                </div>\r\n\r\n                                <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                                    <div>\r\n                                        <label className=\"text-[10px] uppercase font-bold text-gray-500 tracking-widest mb-1 block\">\r\n                                            Slug (ID) *\r\n                                        </label>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={formSlug}\r\n                                            onChange={(e) => setFormSlug(e.target.value.toLowerCase())}\r\n                                            disabled={!!editingSlug}\r\n                                            placeholder=\"np. ver\"\r\n                                            className=\"w-full bg-[#2C2C2E] border border-white/10 p-3 rounded-xl text-white placeholder-gray-600 font-medium focus:border-[#E60000] outline-none transition-colors disabled:opacity-50\"\r\n                                            required\r\n                                        />\r\n                                    </div>\r\n\r\n                                    <div>\r\n                                        <label className=\"text-[10px] uppercase font-bold text-gray-500 tracking-widest mb-1 block\">\r\n                                            Imi─Ö i nazwisko *\r\n                                        </label>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={formName}\r\n                                            onChange={(e) => setFormName(e.target.value)}\r\n                                            placeholder=\"Max Verstappen\"\r\n                                            className=\"w-full bg-[#2C2C2E] border border-white/10 p-3 rounded-xl text-white placeholder-gray-600 font-medium focus:border-[#E60000] outline-none transition-colors\"\r\n                                            required\r\n                                        />\r\n                                    </div>\r\n\r\n                                    <div className=\"grid grid-cols-2 gap-3\">\r\n                                        <div>\r\n                                            <label className=\"text-[10px] uppercase font-bold text-gray-500 tracking-widest mb-1 block\">\r\n                                                Numer *\r\n                                            </label>\r\n                                            <input\r\n                                                type=\"number\"\r\n                                                value={formNumber}\r\n                                                onChange={(e) => setFormNumber(e.target.value)}\r\n                                                placeholder=\"1\"\r\n                                                className=\"w-full bg-[#2C2C2E] border border-white/10 p-3 rounded-xl text-white placeholder-gray-600 font-medium focus:border-[#E60000] outline-none transition-colors\"\r\n                                                required\r\n                                            />\r\n                                        </div>\r\n                                        <div>\r\n                                            <label className=\"text-[10px] uppercase font-bold text-gray-500 tracking-widest mb-1 block\">\r\n                                                Kraj\r\n                                            </label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={formCountry}\r\n                                                onChange={(e) => setFormCountry(e.target.value)}\r\n                                                placeholder=\"­ƒç│­ƒç▒\"\r\n                                                className=\"w-full bg-[#2C2C2E] border border-white/10 p-3 rounded-xl text-white placeholder-gray-600 font-medium focus:border-[#E60000] outline-none transition-colors\"\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div>\r\n                                        <label className=\"text-[10px] uppercase font-bold text-gray-500 tracking-widest mb-1 block\">\r\n                                            Zesp├│┼é *\r\n                                        </label>\r\n                                        <div className=\"relative\">\r\n                                            <select\r\n                                                value={formTeamId}\r\n                                                onChange={(e) => setFormTeamId(e.target.value)}\r\n                                                className=\"w-full bg-[#2C2C2E] border border-white/10 p-3 rounded-xl text-white font-medium focus:border-[#E60000] outline-none transition-colors appearance-none pr-10\"\r\n                                                required\r\n                                            >\r\n                                                <option value=\"\" disabled>Wybierz zesp├│┼é</option>\r\n                                                {teams.map(t => (\r\n                                                    <option key={t.id} value={t.id}>{t.name}</option>\r\n                                                ))}\r\n                                            </select>\r\n                                            <ChevronDown className=\"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500 pointer-events-none\" />\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div>\r\n                                        <label className=\"text-[10px] uppercase font-bold text-gray-500 tracking-widest mb-1 block\">\r\n                                            Kolor (klasy CSS)\r\n                                        </label>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={formColor}\r\n                                            onChange={(e) => setFormColor(e.target.value)}\r\n                                            placeholder=\"bg-blue-900 border-red-600\"\r\n                                            className=\"w-full bg-[#2C2C2E] border border-white/10 p-3 rounded-xl text-white placeholder-gray-600 font-medium focus:border-[#E60000] outline-none transition-colors\"\r\n                                        />\r\n                                    </div>\r\n\r\n                                    <div className=\"flex items-center gap-3 bg-[#2C2C2E] border border-white/10 p-3 rounded-xl\">\r\n                                        <input\r\n                                            type=\"checkbox\"\r\n                                            id=\"activeCheck\"\r\n                                            checked={formActive}\r\n                                            onChange={(e) => setFormActive(e.target.checked)}\r\n                                            className=\"w-5 h-5 accent-[#E60000] rounded focus:ring-0 cursor-pointer\"\r\n                                        />\r\n                                        <label htmlFor=\"activeCheck\" className=\"text-white font-bold text-sm cursor-pointer select-none\">\r\n                                            Aktywny (widoczny w g┼éosowaniach)\r\n                                        </label>\r\n                                    </div>\r\n\r\n                                    <button\r\n                                        type=\"submit\"\r\n                                        disabled={formLoading}\r\n                                        className={clsx(\r\n                                            \"w-full bg-[#E60000] text-white p-4 rounded-xl font-black uppercase tracking-wider text-lg shadow-lg shadow-red-900/20 active:scale-95 transition-all mt-2\",\r\n                                            formLoading && \"opacity-50 cursor-not-allowed\"\r\n                                        )}\r\n                                    >\r\n                                        {formLoading\r\n                                            ? \"Zapisywanie...\"\r\n                                            : editingSlug\r\n                                                ? \"Zapisz zmiany\"\r\n                                                : \"Dodaj kierowc─Ö\"}\r\n                                    </button>\r\n                                </form>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {dataLoading ? (\r\n                        <div className=\"flex items-center justify-center h-32\">\r\n                            <div className=\"animate-spin rounded-full h-8 w-8 border-t-2 border-[#E60000]\"></div>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"space-y-6\">\r\n                            {teams.map(team => {\r\n                                const teamDrivers = drivers.filter(d => d.teamId === team.id);\r\n                                if (teamDrivers.length === 0) return null;\r\n\r\n                                return (\r\n                                    <div key={team.id} className=\"bg-[#1C1C1E] border border-white/5 rounded-2xl overflow-hidden\">\r\n                                        <div className=\"flex items-center gap-3 px-5 py-4 border-b border-white/5\">\r\n                                            <div className=\"w-8 h-8 flex items-center justify-center bg-white/5 rounded-lg p-1\">\r\n                                                <img src={getTeamLogo(team.name)} alt={team.name} className=\"w-full h-full object-contain\" />\r\n                                            </div>\r\n                                            <h3 className=\"font-black text-white uppercase tracking-tight text-sm\">{team.name}</h3>\r\n                                            <span className=\"text-gray-600 text-xs font-bold ml-auto\">{teamDrivers.length} kierowc├│w</span>\r\n                                        </div>\r\n\r\n                                        <div className=\"divide-y divide-white/5\">\r\n                                            {teamDrivers.map(driver => (\r\n                                                <div\r\n                                                    key={driver.slug}\r\n                                                    className=\"flex items-center justify-between px-5 py-4 hover:bg-white/[0.02] transition-colors\"\r\n                                                >\r\n                                                    <div className=\"flex items-center gap-4\">\r\n                                                        <div className=\"w-10 h-10 rounded-xl bg-[#2C2C2E] flex items-center justify-center font-black text-sm text-white\">\r\n                                                            {driver.number}\r\n                                                        </div>\r\n                                                        <div>\r\n                                                            <div className=\"font-bold text-white text-sm\">{driver.name}</div>\r\n                                                            <div className=\"text-gray-500 text-xs font-medium flex items-center gap-2\">\r\n                                                                {driver.country && (\r\n                                                                    <ReactCountryFlag \r\n                                                                        countryCode={driver.country} \r\n                                                                        svg \r\n                                                                        style={{ width: \"1.2em\", height: \"1.2em\", borderRadius: \"50%\", objectFit: \"cover\" }} \r\n                                                                        aria-label={driver.country} \r\n                                                                    />\r\n                                                                )}\r\n                                                                <span>{driver.slug}</span>\r\n                                                                {driver.active === false && (\r\n                                                                    <span className=\"bg-red-900/40 text-red-300 text-[9px] px-1.5 py-0.5 rounded uppercase font-bold tracking-wider border border-red-500/20\">\r\n                                                                        Nieaktywny\r\n                                                                    </span>\r\n                                                                )}\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div className=\"flex items-center gap-2\">\r\n                                                        <button\r\n                                                            onClick={() => openEditForm(driver)}\r\n                                                            className=\"p-2.5 hover:bg-white/10 rounded-xl transition-colors\"\r\n                                                            title=\"Edytuj\"\r\n                                                        >\r\n                                                            <Edit3 className=\"w-4 h-4 text-gray-400\" />\r\n                                                        </button>\r\n                                                        <button\r\n                                                            onClick={() => handleDelete(driver.slug, driver.name)}\r\n                                                            className=\"p-2.5 hover:bg-red-900/30 rounded-xl transition-colors\"\r\n                                                            title=\"Usu┼ä\"\r\n                                                        >\r\n                                                            <Trash2 className=\"w-4 h-4 text-red-500\" />\r\n                                                        </button>\r\n                                                    </div>\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n                                    </div>\r\n                                );\r\n                            })}\r\n                        </div>\r\n                    )}\r\n                </>\r\n            )}\r\n\r\n            {activeTab === \"races\" && (\r\n                <>\r\n                     <div className=\"flex gap-2 mb-8\">\r\n                         <button\r\n                            onClick={() => { resetForm(); setShowForm(true); }}\r\n                            className=\"flex-1 flex items-center justify-center gap-3 p-4 bg-[#E60000] hover:bg-red-700 rounded-2xl font-black uppercase tracking-wider text-white transition-all active:scale-[0.98] shadow-lg shadow-red-900/20\"\r\n                        >\r\n                            <Plus className=\"w-5 h-5\" />\r\n                            Dodaj Wy┼øcig\r\n                        </button>\r\n                        {races.length === 0 && (\r\n                            <button\r\n                                onClick={handleSeedRaces}\r\n                                className=\"px-6 bg-[#2C2C2E] hover:bg-white/10 border border-white/10 rounded-2xl font-bold uppercase text-white transition-all\"\r\n                            >\r\n                                Importuj Domy┼ølne\r\n                            </button>\r\n                        )}\r\n                     </div>\r\n\r\n                    {showForm && (\r\n                        <div className=\"fixed inset-0 bg-black/70 backdrop-blur-sm z-[70] flex items-center justify-center p-4\">\r\n                            <div className=\"bg-[#1C1C1E] border border-white/10 rounded-3xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto\">\r\n                                <div className=\"flex items-center justify-between mb-6\">\r\n                                    <h2 className=\"text-xl font-black text-white uppercase tracking-tight\">\r\n                                        {formRaceId ? \"Edytuj\" : \"Nowy\"} <span className=\"text-[#E60000]\">Wy┼øcig</span>\r\n                                    </h2>\r\n                                    <button onClick={resetForm} className=\"p-2 hover:bg-white/10 rounded-xl transition-colors\">\r\n                                        <X className=\"w-5 h-5 text-gray-400\" />\r\n                                    </button>\r\n                                </div>\r\n\r\n                                <form onSubmit={handleRaceSubmit} className=\"space-y-4\">\r\n                                     <div>\r\n                                        <label className=\"text-[10px] uppercase font-bold text-gray-500 tracking-widest mb-1 block\">\r\n                                            Runda *\r\n                                        </label>\r\n                                        <input\r\n                                            type=\"number\"\r\n                                            value={formRaceRound}\r\n                                            onChange={(e) => setFormRaceRound(e.target.value)}\r\n                                            placeholder=\"1\"\r\n                                            className=\"w-full bg-[#2C2C2E] border border-white/10 p-3 rounded-xl text-white placeholder-gray-600 font-medium focus:border-[#E60000] outline-none transition-colors\"\r\n                                            required\r\n                                        />\r\n                                    </div>\r\n\r\n                                    <div>\r\n                                        <label className=\"text-[10px] uppercase font-bold text-gray-500 tracking-widest mb-1 block\">\r\n                                            Nazwa *\r\n                                        </label>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={formRaceName}\r\n                                            onChange={(e) => setFormRaceName(e.target.value)}\r\n                                            placeholder=\"Grand Prix Bahrajnu\"\r\n                                            className=\"w-full bg-[#2C2C2E] border border-white/10 p-3 rounded-xl text-white placeholder-gray-600 font-medium focus:border-[#E60000] outline-none transition-colors\"\r\n                                            required\r\n                                        />\r\n                                    </div>\r\n\r\n                                    <div>\r\n                                        <label className=\"text-[10px] uppercase font-bold text-gray-500 tracking-widest mb-1 block\">\r\n                                            Data i Czas (UTC/Lokalny) *\r\n                                        </label>\r\n                                        <input\r\n                                            type=\"datetime-local\"\r\n                                            value={formRaceDate}\r\n                                            onChange={(e) => setFormRaceDate(e.target.value)}\r\n                                            className=\"w-full bg-[#2C2C2E] border border-white/10 p-3 rounded-xl text-white placeholder-gray-600 font-medium focus:border-[#E60000] outline-none transition-colors [color-scheme:dark]\"\r\n                                            required\r\n                                        />\r\n                                    </div>\r\n\r\n                                    <div>\r\n                                        <label className=\"text-[10px] uppercase font-bold text-gray-500 tracking-widest mb-1 block\">\r\n                                            Lokalizacja *\r\n                                        </label>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={formRaceLocation}\r\n                                            onChange={(e) => setFormRaceLocation(e.target.value)}\r\n                                            placeholder=\"Sakhir\"\r\n                                            className=\"w-full bg-[#2C2C2E] border border-white/10 p-3 rounded-xl text-white placeholder-gray-600 font-medium focus:border-[#E60000] outline-none transition-colors\"\r\n                                            required\r\n                                        />\r\n                                    </div>\r\n                                    \r\n                                     <div>\r\n                                        <label className=\"text-[10px] uppercase font-bold text-gray-500 tracking-widest mb-1 block\">\r\n                                            Track Image URL (Optional)\r\n                                        </label>\r\n                                        <input\r\n                                            type=\"url\"\r\n                                            value={formRaceTrackImage}\r\n                                            onChange={(e) => setFormRaceTrackImage(e.target.value)}\r\n                                            placeholder=\"https://...\"\r\n                                            className=\"w-full bg-[#2C2C2E] border border-white/10 p-3 rounded-xl text-white placeholder-gray-600 font-medium focus:border-[#E60000] outline-none transition-colors\"\r\n                                        />\r\n                                    </div>\r\n\r\n                                     <div>\r\n                                        <label className=\"text-[10px] uppercase font-bold text-gray-500 tracking-widest mb-1 block\">\r\n                                            Kraj (Opcjonalne)\r\n                                        </label>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={formRaceCountry}\r\n                                            onChange={(e) => setFormRaceCountry(e.target.value)}\r\n                                            placeholder=\"Bahrain\"\r\n                                            className=\"w-full bg-[#2C2C2E] border border-white/10 p-3 rounded-xl text-white placeholder-gray-600 font-medium focus:border-[#E60000] outline-none transition-colors\"\r\n                                        />\r\n                                    </div>\r\n\r\n\r\n                                    <button\r\n                                        type=\"submit\"\r\n                                        disabled={formLoading}\r\n                                        className={clsx(\r\n                                            \"w-full bg-[#E60000] text-white p-4 rounded-xl font-black uppercase tracking-wider text-lg shadow-lg shadow-red-900/20 active:scale-95 transition-all mt-2\",\r\n                                            formLoading && \"opacity-50 cursor-not-allowed\"\r\n                                        )}\r\n                                    >\r\n                                        {formLoading\r\n                                            ? \"Zapisywanie...\"\r\n                                            : formRaceId\r\n                                                ? \"Zapisz zmiany\"\r\n                                                : \"Dodaj wy┼øcig\"}\r\n                                    </button>\r\n                                </form>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    <div className=\"space-y-4\">\r\n                        {races.map(race => (\r\n                             <div key={race.id} className=\"bg-[#1C1C1E] border border-white/5 rounded-2xl p-5 hover:bg-[#252528] transition-all group\">\r\n                                <div className=\"flex items-center justify-between\">\r\n                                    <div className=\"flex items-center gap-4\">\r\n                                         <div className=\"w-12 h-12 bg-[#2C2C2E] rounded-xl flex flex-col items-center justify-center border border-white/5\">\r\n                                            <span className=\"text-[8px] uppercase text-gray-500 font-bold\">Runda</span>\r\n                                            <span className=\"text-xl font-black text-white\">{race.round}</span>\r\n                                        </div>\r\n                                        <div>\r\n                                            <h3 className=\"font-bold text-white text-lg\">{race.name}</h3>\r\n                                            <div className=\"text-gray-500 text-xs font-medium flex items-center gap-2\">\r\n                                                <span>{race.location}</span>\r\n                                                <span>┬À</span>\r\n                                                <span className={new Date(race.date) < new Date() ? \"text-gray-600\" : \"text-[#E60000] font-bold\"}>\r\n                                                    {new Date(race.date).toLocaleDateString()} {new Date(race.date).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}\r\n                                                </span>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                    \r\n                                    <div className=\"flex items-center gap-3\">\r\n                                        {race.trackImage ? (\r\n                                             <span className=\"text-[10px] bg-green-900/30 text-green-400 px-2 py-1 rounded border border-green-500/20 font-bold uppercase tracking-wider\">\r\n                                                 Mapa OK\r\n                                             </span>\r\n                                        ) : (\r\n                                            <span className=\"text-[10px] bg-gray-800 text-gray-500 px-2 py-1 rounded border border-white/10 font-bold uppercase tracking-wider\">\r\n                                                 Brak Mapy\r\n                                             </span>\r\n                                        )}\r\n                                        <div className=\"flex items-center gap-1\">\r\n                                             <button\r\n                                                onClick={() => openRaceForm(race)}\r\n                                                className=\"p-2 hover:bg-white/10 rounded-xl transition-colors\"\r\n                                                title=\"Edytuj\"\r\n                                            >\r\n                                                <Edit3 className=\"w-4 h-4 text-gray-400\" />\r\n                                            </button>\r\n                                             <button\r\n                                                onClick={() => handleDeleteRace(race.id, race.name)}\r\n                                                className=\"p-2 hover:bg-red-900/30 rounded-xl transition-colors\"\r\n                                                title=\"Usu┼ä\"\r\n                                            >\r\n                                                <Trash2 className=\"w-4 h-4 text-red-500\" />\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                             </div>\r\n                        ))}\r\n                    </div>\r\n                </>\r\n            )}\r\n\r\n            {/* Content Content - Users */}\r\n            {activeTab === \"users\" && (\r\n                <div className=\"space-y-4\">\r\n                    {/* User Details Modal */}\r\n                    {(selectedUser || detailsLoading) && (\r\n                        <div className=\"fixed inset-0 bg-black/70 backdrop-blur-sm z-[70] flex items-center justify-center p-4\">\r\n                            <div className=\"bg-[#1C1C1E] border border-white/10 rounded-3xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\r\n                                <div className=\"flex items-center justify-between mb-6\">\r\n                                    <h2 className=\"text-xl font-black text-white uppercase tracking-tight\">\r\n                                        Szczeg├│┼éy <span className=\"text-[#E60000]\">U┼╝ytkownika</span>\r\n                                    </h2>\r\n                                    <button onClick={() => setSelectedUser(null)} className=\"p-2 hover:bg-white/10 rounded-xl transition-colors\">\r\n                                        <X className=\"w-5 h-5 text-gray-400\" />\r\n                                    </button>\r\n                                </div>\r\n\r\n                                {detailsLoading ? (\r\n                                    <div className=\"flex justify-center p-8\">\r\n                                        <div className=\"animate-spin rounded-full h-8 w-8 border-t-2 border-[#E60000]\"></div>\r\n                                    </div>\r\n                                ) : selectedUser && (\r\n                                    <div className=\"space-y-8\">\r\n                                        <div className=\"flex items-center gap-4 border-b border-white/5 pb-6\">\r\n                                            <div className=\"w-16 h-16 rounded-full bg-[#2C2C2E] flex items-center justify-center font-black text-2xl text-gray-500\">\r\n                                                {selectedUser.name?.[0] || \"U\"}\r\n                                            </div>\r\n                                            <div>\r\n                                                <h3 className=\"text-2xl font-bold text-white\">{selectedUser.name || \"Anonim\"}</h3>\r\n                                                <p className=\"text-gray-500 font-medium\">@{selectedUser.username}</p>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        {/* Season Votes */}\r\n                                        <div>\r\n                                            <h4 className=\"text-xs font-black text-gray-500 uppercase tracking-widest mb-4 flex items-center gap-2\">\r\n                                                <Trophy className=\"w-4 h-4 text-[#E60000]\" />\r\n                                                Typy Sezonowe ({selectedUser.seasonVotes.length})\r\n                                            </h4>\r\n                                            {selectedUser.seasonVotes.length > 0 ? (\r\n                                                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-2\">\r\n                                                    {selectedUser.seasonVotes.map((vote) => (\r\n                                                        <div key={vote.position} className=\"flex items-center gap-3 bg-white/[0.03] p-2 rounded-xl\">\r\n                                                            <div className=\"w-8 h-8 rounded-lg bg-[#2C2C2E] flex items-center justify-center font-black text-white text-sm\">\r\n                                                                {vote.position}\r\n                                                            </div>\r\n                                                            <div>\r\n                                                                <div className=\"text-sm font-bold text-white\">{vote.driver}</div>\r\n                                                                <div className=\"text-[10px] text-gray-500 uppercase\">{vote.team}</div>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    ))}\r\n                                                </div>\r\n                                            ) : (\r\n                                                <p className=\"text-gray-600 text-sm italic\">Brak typ├│w na sezon.</p>\r\n                                            )}\r\n                                        </div>\r\n\r\n                                        {/* Race Votes */}\r\n                                        <div>\r\n                                            <h4 className=\"text-xs font-black text-gray-500 uppercase tracking-widest mb-4 flex items-center gap-2\">\r\n                                                <Flag className=\"w-4 h-4 text-white\" />\r\n                                                Ostatnie G┼éosy ({selectedUser.raceVotes.length})\r\n                                            </h4>\r\n                                            {selectedUser.raceVotes.length > 0 ? (\r\n                                                <div className=\"space-y-2\">\r\n                                                    {selectedUser.raceVotes.map((vote, idx) => (\r\n                                                        <div key={idx} className=\"flex items-center justify-between bg-white/[0.03] p-3 rounded-xl\">\r\n                                                            <div>\r\n                                                                <div className=\"text-xs text-gray-500 font-bold uppercase mb-1\">\r\n                                                                    {vote.raceRound}\r\n                                                                </div>\r\n                                                                <div className=\"text-sm font-bold text-white\">{vote.driver}</div>\r\n                                                            </div>\r\n                                                            <div className=\"text-[10px] text-gray-600\">\r\n                                                                {new Date(vote.createdAt).toLocaleDateString()}\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    ))}\r\n                                                </div>\r\n                                            ) : (\r\n                                                <p className=\"text-gray-600 text-sm italic\">Brak g┼éos├│w na wy┼øcigi.</p>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {users.map(userRow => (\r\n                        <div \r\n                            key={userRow.id} \r\n                            onClick={() => handleUserClick(userRow.id)}\r\n                            className=\"bg-[#1C1C1E] border border-white/5 rounded-2xl p-5 hover:bg-[#252528] transition-colors cursor-pointer group\"\r\n                        >\r\n                            <div className=\"flex items-start justify-between\">\r\n                                <div className=\"flex items-center gap-4\">\r\n                                    <div className={clsx(\r\n                                        \"w-12 h-12 rounded-full flex items-center justify-center font-black text-lg border-2\",\r\n                                        userRow.isAdmin ? \"bg-red-900/20 text-[#E60000] border-[#E60000]\" : \"bg-[#2C2C2E] text-gray-400 border-transparent\"\r\n                                    )}>\r\n                                        {userRow.isAdmin ? <Shield className=\"w-5 h-5\" /> : (userRow.name?.[0] || \"U\")}\r\n                                    </div>\r\n                                    <div>\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            <h3 className=\"font-bold text-white text-lg group-hover:text-[#E60000] transition-colors\">{userRow.name || \"Anonim\"}</h3>\r\n                                            {userRow.isAdmin && (\r\n                                                <span className=\"bg-[#E60000] text-white text-[10px] font-bold px-2 py-0.5 rounded-full\">ADMIN</span>\r\n                                            )}\r\n                                        </div>\r\n                                        <div className=\"text-gray-500 text-xs font-medium\">@{userRow.username} ┬À {userRow.team}</div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"text-right flex items-start gap-4\">\r\n                                    <div className=\"flex flex-col gap-1 items-end\">\r\n                                        <div className=\"flex items-center gap-1.5 text-xs text-gray-400 font-bold uppercase tracking-wider\">\r\n                                            <Trophy className=\"w-3 h-3 text-[#E60000]\" />\r\n                                            <span className=\"text-white\">{userRow.seasonVotesCount}</span>\r\n                                            <span className=\"opacity-50\">Sezon</span>\r\n                                        </div>\r\n                                        <div className=\"flex items-center gap-1.5 text-xs text-gray-400 font-bold uppercase tracking-wider\">\r\n                                            <Flag className=\"w-3 h-3 text-white\" />\r\n                                            <span className=\"text-white\">{userRow.votesCount}</span>\r\n                                            <span className=\"opacity-50\">Wy┼øcig</span>\r\n                                        </div>\r\n                                    </div>\r\n                                    \r\n                                    {!userRow.isAdmin && (\r\n                                        <button \r\n                                            onClick={(e) => handleDeleteUser(userRow.id, userRow.username, e)}\r\n                                            className=\"p-2 hover:bg-red-900/30 rounded-lg text-gray-600 hover:text-red-500 transition-colors opacity-0 group-hover:opacity-100\"\r\n                                            title=\"Usu┼ä u┼╝ytkownika\"\r\n                                        >\r\n                                            <Trash2 className=\"w-4 h-4\" />\r\n                                        </button>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\calendar\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'addVote' is assigned a value but never used.","line":49,"column":62,"nodeType":"Identifier","messageId":"unusedVar","endLine":49,"endColumn":69},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":123,"column":111,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":123,"endColumn":114,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4201,4204],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4201,4204],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":166,"column":33,"nodeType":"JSXOpeningElement","endLine":173,"endColumn":35}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { raceResults } from \"@/lib/data\";\r\nimport { clsx } from \"clsx\";\r\nimport Link from \"next/link\";\r\nimport { useStore } from \"@/lib/store\";\r\nimport { calculateRaceScore } from \"@/lib/scoring\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useAuth } from \"@/app/providers/AuthProvider\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { getRaces } from \"@/app/actions/races\";\r\n\r\nconst trackSlugs: Record<number, string> = {\r\n    1: \"melbourne\",\r\n    2: \"shanghai\",\r\n    3: \"suzuka\",\r\n    4: \"sakhir\",\r\n    5: \"jeddah\",\r\n    6: \"miami\",\r\n    7: \"montreal\",\r\n    8: \"monaco\",\r\n    9: \"barcelona\",\r\n    10: \"spielberg\",\r\n    11: \"silverstone\",\r\n    12: \"spa\",\r\n    13: \"budapest\",\r\n    14: \"zandvoort\",\r\n    15: \"monza\",\r\n    16: \"madrid\",\r\n    17: \"baku\",\r\n    18: \"singapore\",\r\n    19: \"austin\",\r\n    20: \"mexico\",\r\n    21: \"saopaulo\",\r\n    22: \"lasvegas\",\r\n    23: \"lusail\",\r\n    24: \"yasmarina\"\r\n};\r\n\r\ntype Race = {\r\n    round: number;\r\n    name: string;\r\n    location: string;\r\n    date: Date;\r\n    trackImage: string | null;\r\n};\r\n\r\nexport default function CalendarPage() {\r\n    const { votes, userId: currentUserId, loadFromIndexedDB, addVote } = useStore();\r\n    const { user, loading: authLoading } = useAuth();\r\n    const router = useRouter();\r\n    const [loading, setLoading] = useState(true);\r\n    const [races, setRaces] = useState<Race[]>([]);\r\n    const now = new Date();\r\n    const completedRaceCount = raceResults.length;\r\n\r\n    useEffect(() => {\r\n        if (!authLoading && user?.isAdmin) {\r\n            router.push(\"/admin\");\r\n            return;\r\n        }\r\n        \r\n        const load = async () => {\r\n             await loadFromIndexedDB();\r\n             const fetchedRaces = await getRaces();\r\n             setRaces(fetchedRaces);\r\n             setLoading(false);\r\n        };\r\n        load();\r\n\r\n    }, [loadFromIndexedDB, user, authLoading, router]);\r\n\r\n    const getRaceStatus = (raceRound: number) => {\r\n        if (raceRound <= completedRaceCount) return \"completed\";\r\n        if (raceRound === completedRaceCount + 1) return \"upcoming\";\r\n        return \"future\";\r\n    };\r\n\r\n    const formatDate = (date: Date) => {\r\n        return new Date(date).toLocaleDateString(\"pl-PL\", {\r\n            day: \"2-digit\",\r\n            month: \"short\",\r\n        });\r\n    };\r\n\r\n    const getCountdown = (date: Date) => {\r\n        const diffTime = new Date(date).getTime() - now.getTime();\r\n        if (diffTime < 0) return null;\r\n        const days = Math.floor(diffTime / (1000 * 60 * 60 * 24));\r\n        const hours = Math.floor((diffTime % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\r\n        if (days === 0) return `${hours}h`;\r\n        if (days < 7) return `${days}d ${hours}h`;\r\n        return `${days}d`;\r\n    };\r\n\r\n    if (loading) return (\r\n        <div className=\"flex items-center justify-center h-[50vh]\">\r\n            <div className=\"animate-spin rounded-full h-8 w-8 border-t-2 border-[#E60000]\"></div>\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <div className=\"pb-32 max-w-4xl mx-auto pt-8\">\r\n            <h1 className=\"text-4xl font-black mb-1 px-4 text-white uppercase tracking-tighter\">\r\n                Terminarz F1 <span className=\"text-[#E60000]\">2026</span>\r\n            </h1>\r\n            <p className=\"text-gray-500 px-4 mb-8 text-sm font-bold tracking-widest\">24 WY┼ÜCIGI ÔÇó MISTRZOSTWA ┼ÜWIATA</p>\r\n\r\n            {/* Calendar Grid */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 px-4\">\r\n                {races.map((race) => {\r\n                    const status = getRaceStatus(race.round);\r\n                    const countdown = status !== \"completed\" ? getCountdown(race.date) : null;\r\n                    const slug = trackSlugs[race.round] || \"melbourne\";\r\n\r\n                    // Calculate points for current user if completed\r\n                    let points = 0;\r\n                    if (status === \"completed\") {\r\n                        const score = calculateRaceScore(currentUserId || \"\", race.round, votes);\r\n                        points = score.totalPoints;\r\n                    }\r\n\r\n                    const CardElement = ((status === \"completed\" || status === \"upcoming\") ? Link : \"div\") as any;\r\n                    const cardProps = status === \"completed\"\r\n                        ? { href: `/race/${race.round}/results` }\r\n                        : status === \"upcoming\"\r\n                            ? { href: `/race/${race.round}` }\r\n                            : {};\r\n\r\n                    return (\r\n                        <CardElement\r\n                            key={race.round}\r\n                            {...cardProps}\r\n                            className={clsx(\r\n                                \"block p-6 rounded-[2rem] transition-all relative overflow-hidden group\",\r\n                                // Dark Grey Card Background\r\n                                \"bg-[#1C1C1E] border border-white/5\",\r\n                                status === \"completed\" && \"opacity-80 hover:opacity-100\",\r\n                                status === \"upcoming\" && \"bg-gradient-to-br from-[#1C1C1E] to-[#2C2C2E] border-[#E60000]/30 shadow-2xl shadow-red-900/10 scale-[1.02] z-10\",\r\n                                status === \"future\" && \"opacity-40\"\r\n                            )}\r\n                        >\r\n                            <div className=\"flex items-start justify-between mb-2\">\r\n                                <div className=\"flex flex-col\">\r\n                                    <span className={clsx(\r\n                                        \"text-[10px] font-black uppercase tracking-[0.2em] mb-1\",\r\n                                        status === \"upcoming\" ? \"text-[#E60000]\" : \"text-gray-600\"\r\n                                    )}>\r\n                                        R{String(race.round).padStart(2, '0')}\r\n                                    </span>\r\n                                    <div className=\"font-black text-2xl leading-none text-white uppercase tracking-tighter mb-1\">\r\n                                        {race.name.replace(\" Grand Prix\", \"\")}\r\n                                    </div>\r\n                                    <div className=\"text-xs text-gray-400 font-bold uppercase tracking-wide\">{race.location}</div>\r\n                                </div>\r\n\r\n                                {status === \"upcoming\" && (\r\n                                    <div className=\"bg-[#E60000] text-white text-[10px] font-black px-2 py-1 rounded-lg animate-pulse\">\r\n                                        NA ┼╗YWO\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n\r\n                            <div className=\"relative h-24 mt-2 mb-4 flex items-center justify-center\">\r\n                                {/* Track Image */}\r\n                                <img\r\n                                    src={race.trackImage || `https://media.formula1.com/image/upload/c_lfill,w_1000/v1740000000/common/f1/2026/track/2026track${slug}blackoutline.svg`}\r\n                                    alt={race.name}\r\n                                    className={clsx(\r\n                                        \"h-full w-auto object-contain transition-transform duration-500 group-hover:scale-110\",\r\n                                        status === \"upcoming\" ? \"opacity-30 invert\" : \"opacity-10 invert\"\r\n                                    )}\r\n                                />\r\n\r\n                                {status === \"completed\" && points > 0 && (\r\n                                    <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                                        <div className=\"bg-[#E60000] text-white font-black px-3 py-1 rounded-full text-sm shadow-lg\">\r\n                                            +{points} PKT\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n\r\n                            <div className=\"flex items-center justify-between border-t border-white/5 pt-4\">\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <div className=\"text-xs text-gray-400 font-bold uppercase\">\r\n                                        {formatDate(race.date)}\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {status === \"completed\" ? (\r\n                                    <div className=\"text-xs font-black text-gray-500 uppercase flex items-center gap-1 group-hover:text-white transition-colors\">\r\n                                        WYNIKI <span>ÔåÆ</span>\r\n                                    </div>\r\n                                ) : countdown ? (\r\n                                    <div className={clsx(\r\n                                        \"px-3 py-1 rounded-xl text-[10px] font-black uppercase tracking-widest\",\r\n                                        status === \"upcoming\" ? \"bg-[#E60000] text-white\" : \"bg-[#2C2C2E] text-gray-500\"\r\n                                    )}>\r\n                                        {countdown}\r\n                                    </div>\r\n                                ) : null}\r\n                            </div>\r\n\r\n                            {/* Accent Glow */}\r\n                            {status === \"upcoming\" && (\r\n                                <div className=\"absolute -top-10 -left-10 w-32 h-32 bg-[#E60000] opacity-5 blur-[40px] rounded-full pointer-events-none\" />\r\n                            )}\r\n                        </CardElement>\r\n                    );\r\n                })}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\components\\Nav.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Shield' is defined but never used.","line":6,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":52,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Shield"},"fix":{"range":[169,177],"text":""},"desc":"Remove unused variable \"Shield\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'idx' is defined but never used.","line":34,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport Link from 'next/link';\r\nimport { usePathname } from 'next/navigation';\r\nimport { clsx } from 'clsx';\r\nimport { Home, Calendar, Flag, Trophy, User, Shield } from 'lucide-react';\r\nimport { useAuth } from '@/app/providers/AuthProvider';\r\n\r\nexport default function Nav({ nextRound = 1 }: { nextRound?: number }) {\r\n  const pathname = usePathname();\r\n  const { user, loading } = useAuth();\r\n\r\n  if (loading || !user) return null;\r\n  if (pathname === \"/login\" || pathname === \"/register\") return null;\r\n\r\n  const tabs = [\r\n    { name: 'Sezon', href: '/season', icon: Home },\r\n    { name: 'Kalendarz', href: '/calendar', icon: Calendar },\r\n    { name: 'Wy┼øcig', href: `/race/${nextRound}`, icon: Flag, isFab: true },\r\n    { name: 'Ranking', href: '/leaderboard', icon: Trophy },\r\n    { name: 'Profil', href: '/profile', icon: User },\r\n  ];\r\n\r\n  return (\r\n    <>\r\n      {/* Admin floating button - acts as Home for admins */}\r\n\r\n\r\n      {/* Main Navigation - Hidden for Admins */}\r\n      {!user.isAdmin && (\r\n        <nav className=\"fixed bottom-6 left-4 right-4 md:left-1/2 md:-translate-x-1/2 md:max-w-md z-50\">\r\n          <div className=\"bg-[#1C1C1E]/90 backdrop-blur-xl border border-white/5 rounded-3xl h-20 shadow-2xl flex items-center justify-between px-2 relative\">\r\n\r\n            {tabs.map((tab, idx) => {\r\n              const isActive = pathname === tab.href || (tab.href !== '/season' && pathname.startsWith(tab.href));\r\n\r\n              if (tab.isFab) {\r\n                return (\r\n                  <div key={tab.name} className=\"relative -top-8\">\r\n                    <Link\r\n                      href={tab.href}\r\n                      className={clsx(\r\n                        \"w-16 h-16 rounded-full flex items-center justify-center shadow-lg transition-transform hover:scale-105 active:scale-95 border-4 border-[#0D0D0D]\",\r\n                        isActive ? \"bg-red-600 shadow-red-600/40\" : \"bg-red-600 shadow-red-600/40\"\r\n                      )}\r\n                    >\r\n                      <tab.icon className=\"w-8 h-8 text-white\" />\r\n                    </Link>\r\n                  </div>\r\n                );\r\n              }\r\n\r\n              return (\r\n                <Link\r\n                  key={tab.name}\r\n                  href={tab.href}\r\n                  className={clsx(\r\n                    \"flex-1 flex flex-col items-center justify-center h-full gap-1 transition-colors\",\r\n                    isActive ? \"text-white\" : \"text-gray-500 hover:text-gray-300\"\r\n                  )}\r\n                >\r\n                  <div className={clsx(\"transition-all duration-300\", isActive ? \"-translate-y-1\" : \"\")}>\r\n                    <tab.icon className=\"w-6 h-6\" />\r\n                  </div>\r\n                  {isActive && (\r\n                    <span className=\"text-[10px] font-medium absolute bottom-3 transition-opacity duration-300 opacity-100\">\r\n                      {tab.name}\r\n                    </span>\r\n                  )}\r\n                </Link>\r\n              );\r\n            })}\r\n          </div>\r\n        </nav>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\leaderboard\\LeaderboardContent.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronLeft' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":21,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"ChevronLeft"},"fix":{"range":[93,138],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":118,"column":25,"nodeType":"JSXOpeningElement","endLine":118,"endColumn":99},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":131,"column":25,"nodeType":"JSXOpeningElement","endLine":135,"endColumn":27},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":185,"column":19,"nodeType":"JSXOpeningElement","endLine":185,"endColumn":93},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":194,"column":19,"nodeType":"JSXOpeningElement","endLine":198,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { clsx } from \"clsx\";\r\nimport { ChevronLeft } from \"lucide-react\";\r\nimport { getTeamLogo } from \"@/lib/data\";\r\nimport { getLeaderboardUsers } from \"@/app/actions/leaderboard\";\r\nimport { useAuth } from \"@/app/providers/AuthProvider\";\r\nimport { useRouter } from \"next/navigation\";\r\n\r\ntype LeaderboardUser = {\r\n  id: string;\r\n  name: string;\r\n  team: string;\r\n  avatar: string;\r\n  voteCount: number;\r\n};\r\n\r\nexport default function LeaderboardContent() {\r\n  const { user: currentUser, loading: authLoading } = useAuth();\r\n  const router = useRouter();\r\n  const [loading, setLoading] = useState(true);\r\n  const [users, setUsers] = useState<LeaderboardUser[]>([]);\r\n\r\n  useEffect(() => {\r\n    if (!authLoading && currentUser?.isAdmin) {\r\n      router.push(\"/admin\");\r\n      return;\r\n    }\r\n\r\n    getLeaderboardUsers()\r\n      .then(setUsers)\r\n      .finally(() => setLoading(false));\r\n  }, [currentUser, authLoading, router]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex h-screen items-center justify-center bg-[#0D0D0D] text-[#E60000]\">\r\n        <div className=\"animate-pulse text-xl font-bold\">┼üADOWANIE RANKINGU...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (users.length === 0) {\r\n    return (\r\n      <div className=\"min-h-screen bg-[#0D0D0D] text-white font-sans pb-24\">\r\n        <div className=\"p-6 pt-12\">\r\n          <h1 className=\"text-4xl font-black text-white mb-1 tracking-tighter uppercase\">\r\n            Ranking\r\n          </h1>\r\n          <p className=\"text-gray-500 text-sm mt-4\">\r\n            Brak zarejestrowanych graczy. Zapro┼ø znajomych!\r\n          </p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Sort by votes for now (will be replaced with scoring later)\r\n  const sorted = [...users].sort((a, b) => b.voteCount - a.voteCount);\r\n\r\n  const top3 = sorted.slice(0, 3);\r\n  const podiumOrder = [top3[1], top3[0], top3[2]].filter(Boolean);\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-[#0D0D0D] text-white font-sans pb-24\">\r\n      {/* Header */}\r\n      <div className=\"p-6 pt-12\">\r\n        <h1 className=\"text-4xl font-black text-white mb-1 tracking-tighter uppercase relative\">\r\n          Ranking\r\n          <div className=\"absolute -bottom-2 w-12 h-1 bg-[#E60000] rounded-full blur-[2px]\"></div>\r\n        </h1>\r\n        <p className=\"text-gray-500 text-xs mt-2 font-medium\">\r\n          {users.length} {users.length === 1 ? 'gracz' : users.length < 5 ? 'graczy' : 'graczy'}\r\n        </p>\r\n      </div>\r\n\r\n      {/* Podium Section */}\r\n      {sorted.length >= 2 && (\r\n        <div className=\"px-4 mb-4\">\r\n          <div className=\"bg-[#1C1C1E] rounded-[2rem] p-6 pb-8 border border-white/5 relative overflow-hidden\">\r\n            <div className=\"absolute top-0 left-0 w-full h-full bg-gradient-to-b from-[#2C2C2E] to-[#0D0D0D] opacity-50 z-0\"></div>\r\n            <div className=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-red-900/10 rounded-full blur-[80px] z-0\"></div>\r\n\r\n            <div className=\"relative z-10 grid grid-cols-3 gap-2 items-end justify-items-center h-64\">\r\n              {podiumOrder.map((u, index) => {\r\n                let rank = 0;\r\n                let isWinner = false;\r\n                let scale = \"scale-90\";\r\n                let ringColor = \"border-slate-500\";\r\n                let heightClass = \"mb-0\";\r\n\r\n                if (index === 0) {\r\n                  rank = 2;\r\n                  ringColor = \"border-slate-300\";\r\n                } else if (index === 1) {\r\n                  rank = 1;\r\n                  isWinner = true;\r\n                  scale = \"scale-110 -translate-y-4\";\r\n                  ringColor = \"border-[#E60000]\";\r\n                  heightClass = \"mb-8\";\r\n                } else if (index === 2) {\r\n                  rank = 3;\r\n                  ringColor = \"border-orange-700\";\r\n                }\r\n\r\n                if (!u) return <div key={index} className=\"w-full\"></div>;\r\n\r\n                const isMe = u.id === currentUser?.id;\r\n\r\n                return (\r\n                  <div key={u.id} className={`flex flex-col items-center text-center transition-all ${scale} ${heightClass}`}>\r\n                    <div className=\"font-bold text-gray-300 mb-2 text-sm uppercase tracking-wider\">\r\n                      {rank}.\r\n                    </div>\r\n                    <div className={`relative p-1 rounded-full border-2 ${ringColor} ${isWinner ? 'shadow-[0_0_20px_rgba(230,0,0,0.3)]' : ''}`}>\r\n                      <div className=\"w-16 h-16 md:w-20 md:h-20 rounded-full overflow-hidden bg-gray-800\">\r\n                        <img src={u.avatar} alt={u.name} className=\"w-full h-full object-cover\" />\r\n                      </div>\r\n                      {isWinner && (\r\n                        <div className=\"absolute -bottom-3 left-1/2 -translate-x-1/2 bg-[#E60000] text-white text-[10px] font-black px-2 py-0.5 rounded-full border border-[#0D0D0D] shadow-lg\">\r\n                          MISTRZ\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"mt-4 space-y-0.5\">\r\n                      <div className=\"font-bold text-white text-sm md:text-base leading-tight\">\r\n                        {isMe ? `${u.name} (Ty)` : u.name}\r\n                      </div>\r\n                      <div className=\"flex items-center justify-center gap-1\">\r\n                        <img\r\n                          src={getTeamLogo(u.team)}\r\n                          alt={u.team}\r\n                          className=\"w-3 h-3 object-contain brightness-0 invert opacity-40\"\r\n                        />\r\n                        <div className=\"text-[10px] text-gray-500 uppercase tracking-widest\">{u.team}</div>\r\n                      </div>\r\n                      <div className={`font-black text-lg md:text-xl ${isWinner ? 'text-[#E60000]' : 'text-white'}`}>\r\n                        {u.voteCount} <span className=\"text-[10px] font-normal opacity-70 text-white\">TYP├ôW</span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* List Section */}\r\n      <div className=\"px-4 space-y-3\">\r\n        {sorted.map((u, index) => {\r\n          const rank = index + 1;\r\n          const isMe = u.id === currentUser?.id;\r\n\r\n          let borderClass = \"border-transparent\";\r\n          let bgClass = \"bg-[#1C1C1E]/50\";\r\n          let numClass = \"text-gray-500\";\r\n\r\n          if (rank === 1) {\r\n            borderClass = \"border-l-4 border-[#E60000]\";\r\n            bgClass = \"bg-gradient-to-r from-[#E60000]/10 to-[#1C1C1E]\";\r\n            numClass = \"text-[#E60000]\";\r\n          } else if (rank === 2) {\r\n            borderClass = \"border-l-4 border-[#c0c0c0]\";\r\n            bgClass = \"bg-gradient-to-r from-[#c0c0c0]/10 to-[#1C1C1E]\";\r\n            numClass = \"text-[#c0c0c0]\";\r\n          } else if (rank === 3) {\r\n            borderClass = \"border-l-4 border-[#cd7f32]\";\r\n            bgClass = \"bg-gradient-to-r from-[#cd7f32]/10 to-[#1C1C1E]\";\r\n            numClass = \"text-[#cd7f32]\";\r\n          }\r\n\r\n          return (\r\n            <div\r\n              key={u.id}\r\n              className={`relative flex items-center p-3 rounded-xl ${bgClass} ${borderClass} overflow-hidden group hover:bg-[#252528] transition-all duration-300 border border-t-white/5 border-b-black/50 border-r-white/5`}\r\n            >\r\n              <div className={`w-8 font-black text-xl mr-3 ${numClass} z-10`}>\r\n                {String(rank).padStart(2, '0')}\r\n              </div>\r\n\r\n              <div className=\"relative w-12 h-12 mr-4 flex-shrink-0 z-10\">\r\n                <div className={`w-full h-full rounded-full overflow-hidden border-2 ${rank === 1 ? 'border-[#E60000]' : 'border-gray-700'}`}>\r\n                  <img src={u.avatar} alt={u.name} className=\"w-full h-full object-cover\" />\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex-1 z-10\">\r\n                <div className={clsx(\"font-bold text-base\", isMe ? \"text-[#E60000]\" : \"text-white\")}>\r\n                  {isMe ? `${u.name} (Ty)` : u.name}\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <img\r\n                    src={getTeamLogo(u.team)}\r\n                    alt={u.team}\r\n                    className=\"w-3 h-3 object-contain brightness-0 invert opacity-40\"\r\n                  />\r\n                  <div className=\"text-xs text-gray-500 font-medium uppercase tracking-wide\">\r\n                    {u.team}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"text-right z-10\">\r\n                {rank <= 3 && (\r\n                  <div className=\"text-[10px] text-gray-400 mb-0.5\">\r\n                    Miejsce {rank}\r\n                  </div>\r\n                )}\r\n                <div className=\"font-black text-white text-lg tracking-tight\">\r\n                  {u.voteCount} <span className=\"text-[#E60000] text-xs\">TYP├ôW</span>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Shine effect */}\r\n              <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-700 ease-in-out z-0\"></div>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\leaderboard\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\login\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":19,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useEffect"},"fix":{"range":[113,123],"text":""},"desc":"Remove unused variable \"useEffect\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":45,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1443,1446],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1443,1446],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useStore } from \"@/lib/store\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { clsx } from \"clsx\";\r\nimport Link from \"next/link\";\r\nimport { loginUser } from \"@/app/actions/auth\";\r\nimport { toast } from \"sonner\";\r\n\r\nexport default function LoginPage() {\r\n    const router = useRouter();\r\n    const { setUserId } = useStore();\r\n    const [username, setUsername] = useState(\"\");\r\n    const [password, setPassword] = useState(\"\");\r\n    const [error, setError] = useState(\"\");\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setLoading(true);\r\n        setError(\"\");\r\n\r\n        try {\r\n            const formData = new FormData(e.target as HTMLFormElement);\r\n            const result = await loginUser(formData);\r\n\r\n            if (result.error) {\r\n                setError(result.error);\r\n                toast.error(result.error);\r\n                return;\r\n            }\r\n\r\n            if (result.success && result.user) {\r\n                toast.success(`Witaj ponownie, ${result.user.name}!`);\r\n                setUserId(result.user.id);\r\n\r\n                if (result.user.isAdmin) {\r\n                    router.replace(\"/admin\");\r\n                    return;\r\n                }\r\n\r\n                router.replace(\"/calendar\");\r\n            }\r\n        } catch (err: any) {\r\n            const msg = err.message || \"An error occurred\";\r\n            setError(msg);\r\n            toast.error(msg);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex flex-col items-center justify-center fixed inset-0 bg-[#0D0D0D] px-4 overflow-hidden z-[60]\">\r\n            <h1 className=\"text-4xl font-black text-white mb-2 uppercase tracking-tighter text-center\">\r\n                F1 Vote <span className=\"text-[#E60000]\">2026</span>\r\n            </h1>\r\n            <p className=\"text-gray-500 mb-8 font-bold tracking-widest text-sm uppercase text-center\">Zaloguj do Padoku</p>\r\n\r\n            <form onSubmit={handleSubmit} className=\"w-full max-w-sm space-y-4\">\r\n                <div>\r\n                    <input\r\n                        type=\"text\"\r\n                        name=\"username\"\r\n                        placeholder=\"Imi─Ö\"\r\n                        value={username}\r\n                        onChange={(e) => setUsername(e.target.value)}\r\n                        className=\"w-full bg-[#1C1C1E] border border-white/10 p-4 rounded-xl text-white placeholder-gray-500 font-medium focus:border-[#E60000] outline-none transition-colors\"\r\n                        required\r\n                    />\r\n                </div>\r\n                <div>\r\n                    <input\r\n                        type=\"password\"\r\n                        name=\"password\"\r\n                        placeholder=\"Has┼éo\"\r\n                        value={password}\r\n                        onChange={(e) => setPassword(e.target.value)}\r\n                        className=\"w-full bg-[#1C1C1E] border border-white/10 p-4 rounded-xl text-white placeholder-gray-500 font-medium focus:border-[#E60000] outline-none transition-colors\"\r\n                        required\r\n                    />\r\n                </div>\r\n\r\n                {error && <div className=\"text-[#E60000] text-sm font-bold text-center\">{error}</div>}\r\n\r\n                <button\r\n                    type=\"submit\"\r\n                    disabled={loading}\r\n                    className={clsx(\r\n                        \"w-full bg-[#E60000] text-white p-4 rounded-xl font-black uppercase tracking-wider text-lg shadow-lg shadow-red-900/20 active:scale-95 transition-all mt-4\",\r\n                        loading && \"opacity-50 cursor-not-allowed\"\r\n                    )}\r\n                >\r\n                    {loading ? \"Rozgrzewanie opon...\" : \"Zaloguj\"}\r\n                </button>\r\n\r\n                <div className=\"text-center mt-6\">\r\n                    <Link href=\"/register\" className=\"text-gray-500 text-sm font-medium hover:text-white transition-colors\">\r\n                        Nowy rekrut? <span className=\"text-[#E60000] font-bold\">Zarejestruj si─Ö</span>\r\n                    </Link>\r\n                </div>\r\n            </form>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\manifest.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\profile\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":78,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":78,"endColumn":21},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":144,"column":21,"nodeType":"JSXOpeningElement","endLine":148,"endColumn":23},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":194,"column":29,"nodeType":"JSXOpeningElement","endLine":198,"endColumn":31}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useAuth } from \"@/app/providers/AuthProvider\";\r\nimport { logoutUser, updateProfile } from \"@/app/actions/auth\";\r\nimport { getProfileOptions } from \"@/app/actions/profile\";\r\nimport { User, LogOut, Edit3, Check, X, ChevronDown } from \"lucide-react\";\r\nimport { getTeamLogo } from \"@/lib/data\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { toast } from \"sonner\";\r\nimport { useRouter } from \"next/navigation\";\r\n\r\ntype Team = { id: string; name: string };\r\ntype DriverOption = { slug: string; name: string; number: number; team: { name: string } };\r\n\r\nexport default function ProfilePage() {\r\n    const { user, loading, refreshUser } = useAuth();\r\n    const router = useRouter();\r\n    const [editing, setEditing] = useState(false);\r\n    \r\n    useEffect(() => {\r\n        if (!loading && user?.isAdmin) {\r\n            router.push(\"/admin\");\r\n        }\r\n    }, [user, loading, router]);\r\n    const [saving, setSaving] = useState(false);\r\n\r\n    // Editable fields\r\n    const [name, setName] = useState(\"\");\r\n    const [selectedTeam, setSelectedTeam] = useState(\"\");\r\n    const [selectedDriver, setSelectedDriver] = useState(\"\");\r\n\r\n    // Dropdown options from DB\r\n    const [teams, setTeams] = useState<Team[]>([]);\r\n    const [drivers, setDrivers] = useState<DriverOption[]>([]);\r\n    const [optionsLoaded, setOptionsLoaded] = useState(false);\r\n\r\n    // Sync form state when user loads\r\n    useEffect(() => {\r\n        if (user) {\r\n            setName(user.name || \"\");\r\n            setSelectedTeam(user.team || \"\");\r\n            setSelectedDriver(user.favoriteDriverSlug || \"\");\r\n        }\r\n    }, [user]);\r\n\r\n    // Load dropdown options when editing starts\r\n    useEffect(() => {\r\n        if (editing && !optionsLoaded) {\r\n            getProfileOptions().then(({ teams, drivers }) => {\r\n                setTeams(teams);\r\n                setDrivers(drivers);\r\n                setOptionsLoaded(true);\r\n            });\r\n        }\r\n    }, [editing, optionsLoaded]);\r\n\r\n    // Filter drivers by selected team\r\n    const filteredDrivers = selectedTeam\r\n        ? drivers.filter(d => d.team.name === selectedTeam)\r\n        : drivers;\r\n\r\n    const handleSave = async () => {\r\n        setSaving(true);\r\n        try {\r\n            const formData = new FormData();\r\n            formData.set(\"name\", name);\r\n            formData.set(\"team\", selectedTeam);\r\n            formData.set(\"favoriteDriver\", selectedDriver);\r\n\r\n            const result = await updateProfile(formData);\r\n            if (result.error) {\r\n                toast.error(result.error);\r\n            } else {\r\n                toast.success(\"Profil zaktualizowany!\");\r\n                await refreshUser();\r\n                setEditing(false);\r\n            }\r\n        } catch (err) {\r\n            toast.error(\"B┼é─àd podczas zapisywania profilu\");\r\n        } finally {\r\n            setSaving(false);\r\n        }\r\n    };\r\n\r\n    const handleCancel = () => {\r\n        // Reset to current user values\r\n        if (user) {\r\n            setName(user.name || \"\");\r\n            setSelectedTeam(user.team || \"\");\r\n            setSelectedDriver(user.favoriteDriverSlug || \"\");\r\n        }\r\n        setEditing(false);\r\n    };\r\n\r\n    if (loading) return (\r\n        <div className=\"flex items-center justify-center h-[50vh]\">\r\n            <div className=\"animate-spin rounded-full h-8 w-8 border-t-2 border-[#E60000]\"></div>\r\n        </div>\r\n    );\r\n\r\n    if (!user) return (\r\n        <div className=\"text-center p-8\">\r\n            <p className=\"text-gray-500 mb-4\">Nie jeste┼ø zalogowany.</p>\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <div className=\"pb-32 pt-8 px-4\">\r\n            <div className=\"flex items-center justify-between mb-8\">\r\n                <h1 className=\"text-4xl font-black text-white uppercase tracking-tighter\">\r\n                    Profil\r\n                </h1>\r\n                {!editing ? (\r\n                    <button\r\n                        onClick={() => setEditing(true)}\r\n                        className=\"flex items-center gap-2 px-4 py-2 bg-[#1C1C1E] hover:bg-[#2C2C2E] border border-white/10 rounded-xl text-sm font-bold text-gray-300 transition-all active:scale-95\"\r\n                    >\r\n                        <Edit3 className=\"w-4 h-4\" />\r\n                        Edytuj\r\n                    </button>\r\n                ) : (\r\n                    <div className=\"flex gap-2\">\r\n                        <button\r\n                            onClick={handleCancel}\r\n                            className=\"flex items-center gap-1 px-3 py-2 bg-[#1C1C1E] hover:bg-[#2C2C2E] border border-white/10 rounded-xl text-sm font-bold text-gray-400 transition-all active:scale-95\"\r\n                        >\r\n                            <X className=\"w-4 h-4\" />\r\n                        </button>\r\n                        <button\r\n                            onClick={handleSave}\r\n                            disabled={saving}\r\n                            className=\"flex items-center gap-1 px-4 py-2 bg-[#E60000] hover:bg-red-700 border border-red-500 rounded-xl text-sm font-bold text-white transition-all active:scale-95 disabled:opacity-50\"\r\n                        >\r\n                            <Check className=\"w-4 h-4\" />\r\n                            {saving ? \"...\" : \"Zapisz\"}\r\n                        </button>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Avatar & Name Card */}\r\n            <div className=\"bg-[#1C1C1E] rounded-[2rem] p-8 border border-white/5 mb-6 text-center\">\r\n                <div className=\"relative inline-block mb-4\">\r\n                    <img\r\n                        src={user.avatar || `https://ui-avatars.com/api/?name=${encodeURIComponent(user.name || \"U\")}&background=E60000&color=fff&bold=true&size=150`}\r\n                        alt={user.name || \"User Avatar\"}\r\n                        className=\"w-24 h-24 rounded-full border-4 border-[#E60000] shadow-lg shadow-red-900/20\"\r\n                    />\r\n                    <div className=\"absolute -bottom-1 -right-1 bg-[#E60000] p-2 rounded-full border-2 border-[#1C1C1E]\">\r\n                        <User className=\"w-4 h-4 text-white\" />\r\n                    </div>\r\n                </div>\r\n\r\n                {editing ? (\r\n                    <div className=\"max-w-xs mx-auto\">\r\n                        <label className=\"text-gray-500 text-[10px] uppercase font-bold mb-2 block text-left\">Imi─Ö</label>\r\n                        <input\r\n                            value={name}\r\n                            onChange={e => setName(e.target.value)}\r\n                            className=\"w-full bg-[#2C2C2E] border border-white/10 rounded-xl px-4 py-3 text-white font-bold text-lg text-center focus:outline-none focus:border-[#E60000] transition-colors\"\r\n                            placeholder=\"Twoje imi─Ö\"\r\n                        />\r\n                    </div>\r\n                ) : (\r\n                    <h2 className=\"text-2xl font-black text-white mb-1 uppercase tracking-tight\">{user.name}</h2>\r\n                )}\r\n            </div>\r\n\r\n            {/* Team & Driver Selection */}\r\n            <div className=\"space-y-4 mb-6\">\r\n                {/* Team */}\r\n                <div className=\"bg-[#1C1C1E] rounded-2xl p-5 border border-white/5\">\r\n                    <div className=\"text-gray-500 text-[10px] uppercase font-bold mb-3 tracking-wider\">Ulubiony zesp├│┼é</div>\r\n                    {editing ? (\r\n                        <div className=\"relative\">\r\n                            <select\r\n                                value={selectedTeam}\r\n                                onChange={e => {\r\n                                    setSelectedTeam(e.target.value);\r\n                                    // Reset driver when team changes\r\n                                    setSelectedDriver(\"\");\r\n                                }}\r\n                                className=\"w-full bg-[#2C2C2E] border border-white/10 rounded-xl px-4 py-3 text-white font-bold appearance-none cursor-pointer focus:outline-none focus:border-[#E60000] transition-colors\"\r\n                            >\r\n                                <option value=\"\">Brak zespo┼éu</option>\r\n                                {teams.map(t => (\r\n                                    <option key={t.id} value={t.name}>{t.name}</option>\r\n                                ))}\r\n                            </select>\r\n                            <ChevronDown className=\"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500 pointer-events-none\" />\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <img\r\n                                src={getTeamLogo(user.team || \"Independent\")}\r\n                                alt={user.team || \"Independent\"}\r\n                                className=\"w-6 h-6 object-contain\"\r\n                            />\r\n                            <span className=\"text-white font-bold text-lg\">{user.team || \"Nie wybrano\"}</span>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Favorite Driver */}\r\n                <div className=\"bg-[#1C1C1E] rounded-2xl p-5 border border-white/5\">\r\n                    <div className=\"text-gray-500 text-[10px] uppercase font-bold mb-3 tracking-wider\">Ulubiony kierowca</div>\r\n                    {editing ? (\r\n                        <div className=\"relative\">\r\n                            <select\r\n                                value={selectedDriver}\r\n                                onChange={e => setSelectedDriver(e.target.value)}\r\n                                className=\"w-full bg-[#2C2C2E] border border-white/10 rounded-xl px-4 py-3 text-white font-bold appearance-none cursor-pointer focus:outline-none focus:border-[#E60000] transition-colors\"\r\n                            >\r\n                                <option value=\"\">Brak ulubionego</option>\r\n                                {filteredDrivers.map(d => (\r\n                                    <option key={d.slug} value={d.slug}>#{d.number} {d.name} ({d.team.name})</option>\r\n                                ))}\r\n                            </select>\r\n                            <ChevronDown className=\"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500 pointer-events-none\" />\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <div className=\"w-6 h-6 rounded-full bg-[#E60000]/20 flex items-center justify-center text-[#E60000] text-xs font-black\">\r\n                                Ôÿà\r\n                            </div>\r\n                            <span className=\"text-white font-bold text-lg\">{user.favoriteDriver || \"Nie wybrano\"}</span>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Status & Season info */}\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                    <div className=\"bg-[#1C1C1E] rounded-2xl p-5 border border-white/5\">\r\n                        <div className=\"text-gray-500 text-[10px] uppercase font-bold mb-1\">Status</div>\r\n                        <div className=\"text-white font-bold text-sm\">Aktywny</div>\r\n                    </div>\r\n                    <div className=\"bg-[#1C1C1E] rounded-2xl p-5 border border-white/5\">\r\n                        <div className=\"text-gray-500 text-[10px] uppercase font-bold mb-1\">Sezon</div>\r\n                        <div className=\"text-white font-bold text-sm\">2026</div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Actions */}\r\n            <div className=\"space-y-3\">\r\n                <button\r\n                    onClick={() => logoutUser()}\r\n                    className=\"w-full flex items-center justify-between p-5 bg-red-900/10 hover:bg-red-900/20 border border-red-900/20 rounded-2xl transition-all group\"\r\n                >\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <LogOut className=\"w-5 h-5 text-[#E60000]\" />\r\n                        <span className=\"font-bold text-[#E60000]\">Wyloguj si─Ö</span>\r\n                    </div>\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\providers\\AuthProvider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\race\\[round]\\VoteComponent.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\race\\[round]\\VoteComponent.tsx:98:7\n   96 |         return posA - posB;\n   97 |       });\n>  98 |       setOrderedDrivers(restored);\n      |       ^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n   99 |     } else {\n  100 |       setOrderedDrivers(drivers);\n  101 |     }","line":98,"column":7,"nodeType":null,"endLine":98,"endColumn":24},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":310,"column":13,"nodeType":"JSXOpeningElement","endLine":314,"endColumn":15}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useStore } from \"@/lib/store\";\r\nimport { Driver, getTeamLogo } from \"@/lib/data\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { clsx } from \"clsx\";\r\nimport { GripVertical } from \"lucide-react\";\r\nimport { useAuth } from \"@/app/providers/AuthProvider\";\r\nimport ReactCountryFlag from \"react-country-flag\";\r\nimport { Card, CardContent } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport {\r\n  DndContext,\r\n  closestCenter,\r\n  KeyboardSensor,\r\n  PointerSensor,\r\n  TouchSensor,\r\n  useSensor,\r\n  useSensors,\r\n  DragEndEvent,\r\n  DragStartEvent,\r\n  DragOverlay,\r\n} from \"@dnd-kit/core\";\r\nimport {\r\n  arrayMove,\r\n  SortableContext,\r\n  sortableKeyboardCoordinates,\r\n  useSortable,\r\n  verticalListSortingStrategy,\r\n} from \"@dnd-kit/sortable\";\r\nimport { CSS } from \"@dnd-kit/utilities\";\r\nimport { toast } from \"sonner\";\r\n\r\ntype Props = {\r\n  race: { round: number; name: string; date: string };\r\n  drivers: Driver[];\r\n};\r\n\r\nexport function VoteComponent({ race, drivers }: Props) {\r\n  const { votes, userId, setSessionVotes, loadFromIndexedDB } = useStore();\r\n  const { user, loading: authLoading } = useAuth();\r\n  const router = useRouter();\r\n  const [timeLeft, setTimeLeft] = useState(\"\");\r\n  const [orderedDrivers, setOrderedDrivers] = useState(drivers);\r\n  const [loading, setLoading] = useState(true);\r\n  const [isLocked, setIsLocked] = useState(false);\r\n  const [activeId, setActiveId] = useState<string | null>(null);\r\n\r\n  // ÔöÇÔöÇ Sensors: PointerSensor for mouse, TouchSensor for mobile ÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇ\r\n  // TouchSensor uses a delay so the user can scroll without accidentally\r\n  // starting a drag. PointerSensor uses distance so small taps don't drag.\r\n  const sensors = useSensors(\r\n    useSensor(PointerSensor, {\r\n      activationConstraint: { distance: 8 },\r\n    }),\r\n    useSensor(TouchSensor, {\r\n      activationConstraint: {\r\n        delay: 200,        // ms of hold before drag starts\r\n        tolerance: 8,      // px of movement allowed during delay\r\n      },\r\n    }),\r\n    useSensor(KeyboardSensor, {\r\n      coordinateGetter: sortableKeyboardCoordinates,\r\n    })\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (!authLoading && user?.isAdmin) {\r\n      router.push(\"/admin\");\r\n      return;\r\n    }\r\n\r\n    loadFromIndexedDB().then(() => {\r\n      setLoading(false);\r\n      const raceDate = new Date(race.date);\r\n      setIsLocked(Date.now() > raceDate.getTime());\r\n    });\r\n  }, [loadFromIndexedDB, race.date, user, authLoading, router]);\r\n\r\n  // Restore previous order from votes\r\n  useEffect(() => {\r\n    if (loading) return;\r\n\r\n    const prefix = `race-${race.round}-position-`;\r\n    const raceVotes = votes.filter(v =>\r\n      v.userId === userId && String(v.raceRound).startsWith(prefix)\r\n    );\r\n\r\n    if (raceVotes.length > 0) {\r\n      const restored = [...drivers].sort((a, b) => {\r\n        const voteA = raceVotes.find(v => v.driverId === a.id);\r\n        const voteB = raceVotes.find(v => v.driverId === b.id);\r\n        const posA = voteA ? parseInt(String(voteA.raceRound).split(\"-\")[3]) : 999;\r\n        const posB = voteB ? parseInt(String(voteB.raceRound).split(\"-\")[3]) : 999;\r\n        return posA - posB;\r\n      });\r\n      setOrderedDrivers(restored);\r\n    } else {\r\n      setOrderedDrivers(drivers);\r\n    }\r\n  }, [loading, votes, userId, drivers, race.round]);\r\n\r\n  // Countdown timer\r\n  useEffect(() => {\r\n    const raceDate = new Date(race.date);\r\n    const updateCountdown = () => {\r\n      const now = new Date();\r\n      const diff = raceDate.getTime() - now.getTime();\r\n      if (diff <= 0) { setTimeLeft(\"WY┼ÜCIG ROZPOCZ─ÿTY\"); setIsLocked(true); return; }\r\n      const days = Math.floor(diff / (1000 * 60 * 60 * 24));\r\n      const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\r\n      const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));\r\n      setTimeLeft(`${days}d ${hours}h ${minutes}m`);\r\n    };\r\n    updateCountdown();\r\n    const interval = setInterval(updateCountdown, 60000);\r\n    return () => clearInterval(interval);\r\n  }, [race.date]);\r\n\r\n  const handleDragStart = (event: DragStartEvent) => {\r\n    setActiveId(event.active.id as string);\r\n  };\r\n\r\n  const handleDragEnd = async (event: DragEndEvent) => {\r\n    setActiveId(null);\r\n    if (isLocked) return;\r\n    const { active, over } = event;\r\n    if (over && active.id !== over.id) {\r\n      const oldIndex = orderedDrivers.findIndex((item) => item.id === active.id);\r\n      const newIndex = orderedDrivers.findIndex((item) => item.id === over.id);\r\n      const newOrder = arrayMove(orderedDrivers, oldIndex, newIndex);\r\n      setOrderedDrivers(newOrder);\r\n      await setSessionVotes(`race-${race.round}-position-`, userId || \"\", newOrder.map(d => d.id));\r\n      toast.success(\"Typy zapisano pomy┼ølnie!\");\r\n    }\r\n  };\r\n\r\n  const activeDriver = activeId ? orderedDrivers.find(d => d.id === activeId) : null;\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex h-[60vh] items-center justify-center\">\r\n        <div className=\"animate-pulse text-[#E60000] font-black text-xl\">┼üADOWANIE STAWKI...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"pb-32 pt-6 px-4\">\r\n      {/* Header */}\r\n      <div className=\"text-center mb-6\">\r\n        <h2 className=\"text-2xl md:text-3xl font-black text-white uppercase leading-tight mb-2\">\r\n          {race.name}\r\n        </h2>\r\n        <div className=\"flex items-center justify-center gap-2 mb-4\">\r\n          <Badge variant=\"secondary\" className=\"text-xs font-bold\">\r\n            Runda {race.round}\r\n          </Badge>\r\n          <Badge\r\n            className={clsx(\r\n              \"text-xs font-bold\",\r\n              isLocked\r\n                ? \"bg-[#E60000] text-white border-[#E60000]\"\r\n                : \"bg-[#E60000]/10 text-[#E60000] border-[#E60000]/20\"\r\n            )}\r\n            variant=\"outline\"\r\n          >\r\n            ÔÅ▒ {timeLeft || \"┼üadowanie...\"}\r\n          </Badge>\r\n        </div>\r\n        <p className=\"text-muted-foreground text-xs uppercase tracking-widest font-bold\">\r\n          {isLocked\r\n            ? \"Stawka zablokowana. Wy┼øcig si─Ö rozpocz─à┼é.\"\r\n            : \"Przytrzymaj i przeci─àgnij, aby ustawi─ç stawk─Ö.\"}\r\n        </p>\r\n      </div>\r\n\r\n      {/* Drag list */}\r\n      <DndContext\r\n        sensors={sensors}\r\n        collisionDetection={closestCenter}\r\n        onDragStart={handleDragStart}\r\n        onDragEnd={handleDragEnd}\r\n      >\r\n        <SortableContext\r\n          items={orderedDrivers.map((d) => d.id)}\r\n          strategy={verticalListSortingStrategy}\r\n        >\r\n          <div className=\"grid grid-cols-1 gap-2 mb-6\">\r\n            {orderedDrivers.map((driver, index) => (\r\n              <SortableDriverCard\r\n                key={driver.id}\r\n                driver={driver}\r\n                index={index}\r\n                disabled={isLocked}\r\n                isBeingDragged={driver.id === activeId}\r\n              />\r\n            ))}\r\n          </div>\r\n        </SortableContext>\r\n\r\n        {/* Floating drag overlay ÔÇö renders the card being held */}\r\n        <DragOverlay adjustScale={false}>\r\n          {activeDriver ? (\r\n            <DriverCardOverlay driver={activeDriver} index={orderedDrivers.findIndex(d => d.id === activeId)} />\r\n          ) : null}\r\n        </DragOverlay>\r\n      </DndContext>\r\n    </div>\r\n  );\r\n}\r\n\r\n/* ÔöÇÔöÇÔöÇ Sortable card (stays in the list, becomes a placeholder while dragging) */\r\nfunction SortableDriverCard({\r\n  driver,\r\n  index,\r\n  disabled,\r\n  isBeingDragged,\r\n}: {\r\n  driver: Driver;\r\n  index: number;\r\n  disabled?: boolean;\r\n  isBeingDragged?: boolean;\r\n}) {\r\n  const {\r\n    attributes,\r\n    listeners,\r\n    setNodeRef,\r\n    transform,\r\n    transition,\r\n  } = useSortable({ id: driver.id, disabled });\r\n\r\n  const style = {\r\n    transform: CSS.Transform.toString(transform),\r\n    transition: transition ?? \"transform 200ms cubic-bezier(0.25, 1, 0.5, 1)\",\r\n  };\r\n\r\n  return (\r\n    <div ref={setNodeRef} style={style}>\r\n      <DriverCard\r\n        driver={driver}\r\n        index={index}\r\n        disabled={disabled}\r\n        dragHandleProps={{ ...attributes, ...listeners }}\r\n        ghost={isBeingDragged}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\n/* ÔöÇÔöÇÔöÇ The actual visual card (shared between list + overlay) */\r\nfunction DriverCard({\r\n  driver,\r\n  index,\r\n  disabled,\r\n  dragHandleProps,\r\n  ghost,\r\n  overlay,\r\n}: {\r\n  driver: Driver;\r\n  index: number;\r\n  disabled?: boolean;\r\n  dragHandleProps?: React.HTMLAttributes<HTMLDivElement>;\r\n  ghost?: boolean;\r\n  overlay?: boolean;\r\n}) {\r\n  const isPodium = index < 3;\r\n  const teamColorClass = driver.color?.split(\" \")[0] ?? \"bg-gray-500\";\r\n\r\n  return (\r\n    <Card\r\n      className={clsx(\r\n        \"border-border bg-card transition-all duration-150 select-none overflow-hidden\",\r\n        // Left team-colour accent stripe via border-left trick\r\n        teamColorClass.replace(\"bg-\", \"border-l-4 border-\"),\r\n        ghost && \"opacity-30 scale-[0.98]\",\r\n        overlay && \"shadow-2xl shadow-black/60 ring-2 ring-[#E60000] scale-[1.02] rotate-1\",\r\n        !disabled && !ghost && \"active:scale-[0.99]\"\r\n      )}\r\n    >\r\n      <CardContent className=\"flex items-center gap-3 p-3\">\r\n        {/* Position badge */}\r\n        <div\r\n          className={clsx(\r\n            \"w-9 h-9 rounded-xl flex items-center justify-center flex-shrink-0 font-black text-lg\",\r\n            isPodium ? \"bg-[#E60000] text-white\" : \"bg-secondary text-muted-foreground\"\r\n          )}\r\n        >\r\n          {index + 1}\r\n        </div>\r\n\r\n        {/* Driver number */}\r\n        <span className=\"text-base font-bold w-9 text-muted-foreground flex-shrink-0\">\r\n          #{driver.number}\r\n        </span>\r\n\r\n        {/* Driver info */}\r\n        <div className=\"flex-1 min-w-0 text-left\">\r\n          <div className=\"font-bold text-sm text-foreground truncate flex items-center gap-2\">\r\n            <ReactCountryFlag\r\n              countryCode={driver.country}\r\n              svg\r\n              style={{ width: \"1.1em\", height: \"1.1em\", borderRadius: \"50%\", objectFit: \"cover\" }}\r\n              aria-label={driver.country}\r\n            />\r\n            <span>{driver.name}</span>\r\n          </div>\r\n          <div className=\"flex items-center gap-1.5 mt-0.5\">\r\n            <img\r\n              src={getTeamLogo(driver.team)}\r\n              alt={driver.team}\r\n              className=\"w-3.5 h-3.5 object-contain\"\r\n            />\r\n            <span className=\"text-[10px] text-muted-foreground uppercase truncate font-medium\">\r\n              {driver.team}\r\n            </span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Team colour stripe */}\r\n        <div className={clsx(\"w-1.5 h-8 rounded-full flex-shrink-0 opacity-70\", teamColorClass)} />\r\n\r\n        {/* Drag handle */}\r\n        {!disabled && (\r\n          <div\r\n            {...dragHandleProps}\r\n            className={clsx(\r\n              \"ml-1 p-2 rounded-lg text-muted-foreground hover:text-foreground hover:bg-white/5 transition-colors flex-shrink-0\",\r\n              \"cursor-grab active:cursor-grabbing touch-none\"\r\n            )}\r\n            aria-label=\"Drag to reorder\"\r\n          >\r\n            <GripVertical className=\"w-5 h-5\" />\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n\r\n/* ÔöÇÔöÇÔöÇ Overlay card (rendered by DragOverlay while dragging) */\r\nfunction DriverCardOverlay({ driver, index }: { driver: Driver; index: number }) {\r\n  return (\r\n    <DriverCard\r\n      driver={driver}\r\n      index={index}\r\n      overlay\r\n    />\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\race\\[round]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\race\\[round]\\results\\RaceResultsContent.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'currentUserId' is assigned a value but never used.","line":15,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":41},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":114,"column":45,"nodeType":"JSXOpeningElement","endLine":118,"endColumn":47}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useStore } from \"@/lib/store\";\r\nimport { drivers, races, getTeamLogo, raceResults } from \"@/lib/data\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { clsx } from \"clsx\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useAuth } from \"@/app/providers/AuthProvider\";\r\n\r\ntype Props = {\r\n    raceRound: number;\r\n};\r\n\r\nexport default function RaceResultsContent({ raceRound }: Props) {\r\n    const { votes, userId: currentUserId, loadFromIndexedDB } = useStore();\r\n    const { user, loading: authLoading } = useAuth();\r\n    const [loading, setLoading] = useState(true);\r\n    const router = useRouter();\r\n\r\n    useEffect(() => {\r\n        if (!authLoading && user?.isAdmin) {\r\n            router.push(\"/admin\");\r\n            return;\r\n        }\r\n        loadFromIndexedDB().then(() => setLoading(false));\r\n    }, [loadFromIndexedDB, user, authLoading, router]);\r\n\r\n    const result = raceResults.find((r) => r.round === raceRound);\r\n    const race = races.find((r) => r.round === raceRound);\r\n\r\n    if (!result || !race) {\r\n        return (\r\n            <div className=\"text-center p-8 flex flex-col items-center justify-center h-[50vh]\">\r\n                <p className=\"text-gray-500 font-medium mb-4\">Wy┼øcig w toku lub wyniki s─à niedost─Öpne.</p>\r\n                <button\r\n                    onClick={() => router.push(\"/calendar\")}\r\n                    className=\"px-6 py-3 bg-[#E60000] text-white font-bold rounded-xl shadow-lg shadow-red-900/20 active:scale-95 transition-all\"\r\n                >\r\n                    Wr├│─ç do terminarza\r\n                </button>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex h-screen items-center justify-center bg-[#0D0D0D] text-[#E60000]\">\r\n                <div className=\"animate-pulse text-xl font-bold\">┼üADOWANIE WYNIK├ôW...</div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Get user's votes for this race\r\n    const userVotes = votes.filter(v =>\r\n        typeof v.raceRound === \"string\" &&\r\n        v.raceRound.startsWith(`race-${raceRound}-position-`)\r\n    );\r\n\r\n    return (\r\n        <div className=\"pb-24 pt-8 px-4\">\r\n            {/* Race Header */}\r\n            <div className=\"mb-8 text-center\">\r\n                <div className=\"text-xs font-bold text-[#E60000] uppercase tracking-widest mb-2 border border-[#E60000]/20 bg-[#E60000]/5 inline-block px-3 py-1 rounded-full\">\r\n                    Runda {race.round}\r\n                </div>\r\n                <h1 className=\"text-3xl font-black mb-1 text-white uppercase leading-none tracking-tight\">\r\n                    {race.name}\r\n                </h1>\r\n                <p className=\"text-gray-500 text-sm font-medium\">{race.location}</p>\r\n            </div>\r\n\r\n            {/* Full Classification */}\r\n            <div className=\"space-y-3\">\r\n                <h2 className=\"text-sm font-bold text-gray-400 uppercase tracking-widest mb-4\">­ƒÅü Wyniki i Twoje Typy</h2>\r\n                {result.fullResults.map((driverId, position) => {\r\n                    const driver = drivers.find((d) => d.id === driverId);\r\n                    if (!driver) return null;\r\n\r\n                    // Find what position the user predicted for this driver\r\n                    const userPrediction = userVotes.find(v => v.driverId === driverId);\r\n                    let predictedPos: number | null = null;\r\n                    if (userPrediction && typeof userPrediction.raceRound === \"string\") {\r\n                        predictedPos = parseInt(userPrediction.raceRound.split(\"-\")[3]);\r\n                    }\r\n\r\n                    const isPerfect = predictedPos === position + 1;\r\n                    const isClose = predictedPos !== null && Math.abs(predictedPos - (position + 1)) <= 2;\r\n\r\n                    return (\r\n                        <div\r\n                            key={driverId}\r\n                            className={clsx(\r\n                                \"p-4 rounded-xl border transition-all relative overflow-hidden\",\r\n                                \"bg-[#1C1C1E]\",\r\n                                position === 0 ? \"border-[#E60000] bg-gradient-to-br from-[#E60000]/10 to-[#1C1C1E]\" : \"border-white/5\"\r\n                            )}\r\n                        >\r\n                            <div className=\"flex items-center justify-between relative z-10\">\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <div\r\n                                        className={clsx(\r\n                                            \"w-8 h-8 rounded-lg flex items-center justify-center font-bold text-sm\",\r\n                                            position === 0 ? \"bg-[#E60000] text-white\" : \"bg-[#2C2C2E] text-gray-500\"\r\n                                        )}\r\n                                    >\r\n                                        {position + 1}\r\n                                    </div>\r\n                                    <div>\r\n                                        <div className=\"font-bold text-base text-white flex items-center gap-2\">\r\n                                            {driver.name}\r\n                                            {position === 0 && <span className=\"text-[10px] bg-[#E60000] text-white px-1.5 rounded uppercase\">Wygrana</span>}\r\n                                        </div>\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            <img\r\n                                                src={getTeamLogo(driver.team)}\r\n                                                alt={driver.team}\r\n                                                className=\"w-3 h-3 object-contain\"\r\n                                            />\r\n                                            <div className=\"text-[10px] text-gray-500 uppercase font-medium\">{driver.team}</div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <div className={clsx(\"w-1.5 h-8 rounded-full opacity-80\", driver.color.split(\" \")[0])} />\r\n                                    {predictedPos !== null && (\r\n                                        <div className={clsx(\r\n                                            \"flex flex-col items-center justify-center px-2 py-1 rounded-lg border text-center min-w-[44px]\",\r\n                                            isPerfect\r\n                                                ? \"bg-[#E60000] border-[#E60000] text-white shadow-lg shadow-red-600/20\"\r\n                                                : isClose\r\n                                                    ? \"bg-green-900/40 border-green-500/30 text-green-400\"\r\n                                                    : \"bg-[#2C2C2E] border-white/5 text-gray-400\"\r\n                                        )}>\r\n                                            <div className=\"text-[8px] font-bold uppercase opacity-80\">Tw├│j typ</div>\r\n                                            <div className=\"text-xs font-black\">P{predictedPos}</div>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    );\r\n                })}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\race\\[round]\\results\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\register\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":93,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":93,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3375,3378],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3375,3378],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":137,"column":33,"nodeType":"JSXOpeningElement","endLine":141,"endColumn":35},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":165,"column":37,"nodeType":"JSXOpeningElement","endLine":169,"endColumn":39},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":193,"column":33,"nodeType":"JSXOpeningElement","endLine":197,"endColumn":35},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":221,"column":37,"nodeType":"JSXOpeningElement","endLine":225,"endColumn":39}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useStore } from \"@/lib/store\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useEffect, useState, useRef } from \"react\";\r\nimport { clsx } from \"clsx\";\r\nimport Link from \"next/link\";\r\nimport { registerUser } from \"@/app/actions/auth\";\r\nimport { drivers, getTeamLogo } from \"@/lib/data\";\r\nimport { toast } from \"sonner\";\r\nimport { ChevronDown } from \"lucide-react\";\r\nimport { useAuth } from \"@/app/providers/AuthProvider\";\r\n\r\nexport default function RegisterPage() {\r\n    const router = useRouter();\r\n    const { setUserId } = useStore();\r\n    const { user, loading: authLoading } = useAuth();\r\n    const [name, setName] = useState(\"\");\r\n    const [team, setTeam] = useState(\"\");\r\n    const [favoriteDriver, setFavoriteDriver] = useState(\"\");\r\n    const [password, setPassword] = useState(\"\");\r\n    const [error, setError] = useState(\"\");\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const [teamOpen, setTeamOpen] = useState(false);\r\n    const [driverOpen, setDriverOpen] = useState(false);\r\n\r\n    const teamRef = useRef<HTMLDivElement>(null);\r\n    const driverRef = useRef<HTMLDivElement>(null);\r\n\r\n    const teams = Array.from(new Set(drivers.map(d => d.team))).sort();\r\n    const sortedDrivers = [...drivers].sort((a, b) => a.name.localeCompare(b.name));\r\n\r\n    // Redirect if already logged in\r\n    useEffect(() => {\r\n        if (!authLoading && user) {\r\n            router.push(user.isAdmin ? \"/admin\" : \"/season\");\r\n        }\r\n    }, [user, authLoading, router]);\r\n\r\n    // Close dropdowns on outside click\r\n    useEffect(() => {\r\n        function handleClick(e: MouseEvent) {\r\n            if (teamRef.current && !teamRef.current.contains(e.target as Node)) {\r\n                setTeamOpen(false);\r\n            }\r\n            if (driverRef.current && !driverRef.current.contains(e.target as Node)) {\r\n                setDriverOpen(false);\r\n            }\r\n        }\r\n        document.addEventListener(\"mousedown\", handleClick);\r\n        return () => document.removeEventListener(\"mousedown\", handleClick);\r\n    }, []);\r\n\r\n    const selectedDriver = drivers.find(d => d.id === favoriteDriver);\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n\r\n        if (!team) {\r\n            toast.error(\"Wybierz sw├│j ulubiony zesp├│┼é\");\r\n            return;\r\n        }\r\n        if (!favoriteDriver) {\r\n            toast.error(\"Wybierz swojego ulubionego kierowc─Ö\");\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        setError(\"\");\r\n\r\n        try {\r\n            const formData = new FormData();\r\n            formData.append(\"name\", name);\r\n            formData.append(\"team\", team);\r\n            formData.append(\"favoriteDriver\", favoriteDriver);\r\n            formData.append(\"username\", name); // Use name as username\r\n            formData.append(\"password\", password);\r\n\r\n            const result = await registerUser(formData);\r\n\r\n            if (result.error) {\r\n                setError(result.error);\r\n                toast.error(result.error);\r\n                return;\r\n            }\r\n\r\n            if (result.success && result.user) {\r\n                toast.success(\"Zarejestrowano pomy┼ølnie!\");\r\n                setUserId(result.user.id); // Update local store\r\n                router.push(\"/season\"); // Redirect to season voting\r\n            }\r\n        } catch (err: any) {\r\n            const msg = err.message || \"An error occurred\";\r\n            setError(msg);\r\n            toast.error(msg);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex flex-col items-center justify-center fixed inset-0 bg-[#0D0D0D] px-4 overflow-hidden z-[60]\">\r\n            <h1 className=\"text-4xl font-black text-white mb-2 uppercase tracking-tighter text-center\">\r\n                F1 Vote <span className=\"text-[#E60000]\">2026</span>\r\n            </h1>\r\n            <p className=\"text-gray-500 mb-8 font-bold tracking-widest text-sm uppercase text-center\">Do┼é─àcz do stawki</p>\r\n\r\n            <form onSubmit={handleSubmit} className=\"w-full max-w-sm space-y-4\">\r\n                <div>\r\n                    <input\r\n                        type=\"text\"\r\n                        placeholder=\"Imi─Ö\"\r\n                        value={name}\r\n                        onChange={(e) => setName(e.target.value)}\r\n                        className=\"w-full bg-[#1C1C1E] border border-white/10 p-4 rounded-xl text-white placeholder-gray-500 font-medium focus:border-[#E60000] outline-none transition-colors\"\r\n                        required\r\n                    />\r\n                </div>\r\n\r\n                {/* Custom Team Dropdown */}\r\n                <div ref={teamRef} className=\"relative\">\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={() => {\r\n                            setTeamOpen(!teamOpen);\r\n                            setDriverOpen(false);\r\n                        }}\r\n                        className={clsx(\r\n                            \"w-full bg-[#1C1C1E] border border-white/10 p-4 rounded-xl font-medium text-left flex items-center gap-3 transition-colors\",\r\n                            team ? \"text-white\" : \"text-gray-500\",\r\n                            teamOpen && \"border-[#E60000]\"\r\n                        )}\r\n                    >\r\n                        {team ? (\r\n                            <>\r\n                                <img\r\n                                    src={getTeamLogo(team)}\r\n                                    alt={team}\r\n                                    className=\"w-5 h-5 object-contain\"\r\n                                />\r\n                                <span className=\"flex-1\">{team}</span>\r\n                            </>\r\n                        ) : (\r\n                            <span className=\"flex-1\">Ulubiony zesp├│┼é</span>\r\n                        )}\r\n                        <ChevronDown className={clsx(\"w-4 h-4 text-gray-500 transition-transform\", teamOpen && \"rotate-180\")} />\r\n                    </button>\r\n\r\n                    {teamOpen && (\r\n                        <div className=\"absolute z-[70] top-full mt-1 left-0 right-0 bg-[#1C1C1E] border border-white/10 rounded-xl overflow-hidden shadow-2xl shadow-black/50 max-h-60 overflow-y-auto\">\r\n                            {teams.map(t => (\r\n                                <button\r\n                                    key={t}\r\n                                    type=\"button\"\r\n                                    onClick={() => {\r\n                                        setTeam(t);\r\n                                        setTeamOpen(false);\r\n                                    }}\r\n                                    className={clsx(\r\n                                        \"w-full flex items-center gap-3 px-4 py-3 text-left hover:bg-[#2C2C2E] transition-colors\",\r\n                                        team === t ? \"text-[#E60000] bg-[#E60000]/5\" : \"text-white\"\r\n                                    )}\r\n                                >\r\n                                    <img\r\n                                        src={getTeamLogo(t)}\r\n                                        alt={t}\r\n                                        className=\"w-5 h-5 object-contain\"\r\n                                    />\r\n                                    <span className=\"font-medium\">{t}</span>\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Custom Driver Dropdown */}\r\n                <div ref={driverRef} className=\"relative\">\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={() => {\r\n                            setDriverOpen(!driverOpen);\r\n                            setTeamOpen(false);\r\n                        }}\r\n                        className={clsx(\r\n                            \"w-full bg-[#1C1C1E] border border-white/10 p-4 rounded-xl font-medium text-left flex items-center gap-3 transition-colors\",\r\n                            favoriteDriver ? \"text-white\" : \"text-gray-500\",\r\n                            driverOpen && \"border-[#E60000]\"\r\n                        )}\r\n                    >\r\n                        {selectedDriver ? (\r\n                            <>\r\n                                <img\r\n                                    src={getTeamLogo(selectedDriver.team)}\r\n                                    alt={selectedDriver.team}\r\n                                    className=\"w-5 h-5 object-contain\"\r\n                                />\r\n                                <span className=\"flex-1\">{selectedDriver.name}</span>\r\n                            </>\r\n                        ) : (\r\n                            <span className=\"flex-1\">Ulubiony kierowca</span>\r\n                        )}\r\n                        <ChevronDown className={clsx(\"w-4 h-4 text-gray-500 transition-transform\", driverOpen && \"rotate-180\")} />\r\n                    </button>\r\n\r\n                    {driverOpen && (\r\n                        <div className=\"absolute z-[70] top-full mt-1 left-0 right-0 bg-[#1C1C1E] border border-white/10 rounded-xl overflow-hidden shadow-2xl shadow-black/50 max-h-60 overflow-y-auto\">\r\n                            {sortedDrivers.map(d => (\r\n                                <button\r\n                                    key={d.id}\r\n                                    type=\"button\"\r\n                                    onClick={() => {\r\n                                        setFavoriteDriver(d.id);\r\n                                        setDriverOpen(false);\r\n                                    }}\r\n                                    className={clsx(\r\n                                        \"w-full flex items-center gap-3 px-4 py-3 text-left hover:bg-[#2C2C2E] transition-colors\",\r\n                                        favoriteDriver === d.id ? \"text-[#E60000] bg-[#E60000]/5\" : \"text-white\"\r\n                                    )}\r\n                                >\r\n                                    <img\r\n                                        src={getTeamLogo(d.team)}\r\n                                        alt={d.team}\r\n                                        className=\"w-5 h-5 object-contain\"\r\n                                    />\r\n                                    <div className=\"flex flex-col\">\r\n                                        <span className=\"font-medium text-sm\">{d.name}</span>\r\n                                        <span className=\"text-[10px] text-gray-500 uppercase tracking-tighter\">{d.team}</span>\r\n                                    </div>\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                <div>\r\n                    <input\r\n                        type=\"password\"\r\n                        placeholder=\"Has┼éo\"\r\n                        value={password}\r\n                        onChange={(e) => setPassword(e.target.value)}\r\n                        className=\"w-full bg-[#1C1C1E] border border-white/10 p-4 rounded-xl text-white placeholder-gray-500 font-medium focus:border-[#E60000] outline-none transition-colors\"\r\n                        required\r\n                    />\r\n                </div>\r\n\r\n                {error && <div className=\"text-[#E60000] text-sm font-bold text-center\">{error}</div>}\r\n\r\n                <button\r\n                    type=\"submit\"\r\n                    disabled={loading}\r\n                    className={clsx(\r\n                        \"w-full bg-[#E60000] text-white p-4 rounded-xl font-black uppercase tracking-wider text-lg shadow-lg shadow-red-900/20 active:scale-95 transition-all mt-4\",\r\n                        loading && \"opacity-50 cursor-not-allowed\"\r\n                    )}\r\n                >\r\n                    {loading ? \"Rejestrowanie...\" : \"Zarejestruj\"}\r\n                </button>\r\n\r\n                <div className=\"text-center mt-6\">\r\n                    <Link href=\"/login\" className=\"text-gray-500 text-sm font-medium hover:text-white transition-colors\">\r\n                        Ju┼╝ w stawce? <span className=\"text-[#E60000] font-bold\">Zaloguj si─Ö</span>\r\n                    </Link>\r\n                </div>\r\n            </form>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\season\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useRef' is defined but never used.","line":4,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useRef"},"fix":{"range":[91,99],"text":""},"desc":"Remove unused variable \"useRef\"."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":123,"column":11,"nodeType":"JSXOpeningElement","endLine":127,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useEffect, useState, useRef } from \"react\";\r\nimport { clsx } from \"clsx\";\r\nimport { GripVertical, Plus, X, Lock, Trophy, Star } from \"lucide-react\";\r\nimport ReactCountryFlag from \"react-country-flag\";\r\nimport {\r\n  DndContext,\r\n  closestCenter,\r\n  KeyboardSensor,\r\n  PointerSensor,\r\n  useSensor,\r\n  useSensors,\r\n  DragEndEvent,\r\n} from \"@dnd-kit/core\";\r\nimport {\r\n  arrayMove,\r\n  SortableContext,\r\n  sortableKeyboardCoordinates,\r\n  useSortable,\r\n  verticalListSortingStrategy,\r\n} from \"@dnd-kit/sortable\";\r\nimport { CSS } from \"@dnd-kit/utilities\";\r\nimport { getTeamLogo } from \"@/lib/data\";\r\nimport { toast } from \"sonner\";\r\nimport { useAuth } from \"@/app/providers/AuthProvider\";\r\nimport {\r\n  getSeasonVotes,\r\n  getAvailableDrivers,\r\n  addSeasonVote,\r\n  removeSeasonVote,\r\n  reorderSeasonVotes,\r\n  isSeasonLocked,\r\n} from \"@/app/actions/seasonVote\";\r\n\r\ntype DriverInfo = {\r\n  slug: string;\r\n  name: string;\r\n  number: number;\r\n  country: string | null;\r\n  color: string | null;\r\n  team: string;\r\n};\r\n\r\ntype PickedDriver = DriverInfo & { position: number };\r\n\r\n// ÔöÇÔöÇÔöÇ Sortable Driver Item ÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇ\r\nfunction SortableDriverItem({\r\n  driver,\r\n  index,\r\n  locked,\r\n  onRemove,\r\n}: {\r\n  driver: PickedDriver;\r\n  index: number;\r\n  locked: boolean;\r\n  onRemove: (slug: string) => void;\r\n}) {\r\n  const {\r\n    attributes,\r\n    listeners,\r\n    setNodeRef,\r\n    transform,\r\n    transition,\r\n    isDragging,\r\n  } = useSortable({ id: driver.slug, disabled: locked });\r\n\r\n  const style = {\r\n    transform: CSS.Transform.toString(transform),\r\n    transition,\r\n  };\r\n\r\n  const isChampion = index === 0;\r\n  const isPodium = index < 3;\r\n  const teamColor = driver.color?.split(\" \")[0] || \"bg-gray-600\";\r\n\r\n  return (\r\n    <div\r\n      ref={setNodeRef}\r\n      style={style}\r\n      className={clsx(\r\n        \"flex items-center p-2.5 md:p-3 rounded-2xl transition-all touch-manipulation select-none border border-white/5\",\r\n        \"bg-[#1C1C1E] group relative overflow-hidden\",\r\n        isDragging && \"opacity-90 scale-[0.98] shadow-2xl z-50 ring-2 ring-[#E60000] border-[#E60000]/30\",\r\n        isChampion && \"ring-1 ring-yellow-500/20 bg-gradient-to-r from-yellow-500/5 to-transparent\"\r\n      )}\r\n    >\r\n      {/* Glow Effect for Champion */}\r\n      {isChampion && (\r\n        <div className=\"absolute inset-0 bg-yellow-500/5 blur-xl pointer-events-none\" />\r\n      )}\r\n\r\n      {/* Position */}\r\n      <div\r\n        className={clsx(\r\n          \"w-10 h-10 rounded-xl flex items-center justify-center mr-3 flex-shrink-0 font-black text-xl transition-colors\",\r\n          isPodium ? \"bg-[#E60000] text-white shadow-lg shadow-red-900/20\" : \"bg-[#2C2C2E] text-gray-500\"\r\n        )}\r\n      >\r\n        {isChampion ? <Star className=\"w-5 h-5 fill-white\" /> : index + 1}\r\n      </div>\r\n\r\n      {/* Driver Number */}\r\n      <span className=\"text-lg font-bold w-10 text-gray-600 flex-shrink-0\">\r\n        #{driver.number}\r\n      </span>\r\n\r\n      {/* Driver Info */}\r\n      <div className=\"text-left flex-1 min-w-0\">\r\n        <div className=\"font-bold text-base leading-tight truncate flex items-center gap-2 text-white\">\r\n          {driver.country && (\r\n            <ReactCountryFlag\r\n              countryCode={driver.country}\r\n              svg\r\n              style={{ width: \"1.2em\", height: \"1.2em\", borderRadius: \"50%\", objectFit: \"cover\" }}\r\n              aria-label={driver.country}\r\n            />\r\n          )}\r\n          <span className={clsx(isChampion && \"text-yellow-500\")}>{driver.name}</span>\r\n        </div>\r\n        <div className=\"flex items-center gap-1.5 mt-0.5\">\r\n          <img\r\n            src={getTeamLogo(driver.team)}\r\n            alt={driver.team}\r\n            className=\"w-3.5 h-3.5 object-contain\"\r\n          />\r\n          <div className=\"text-[10px] text-gray-500 uppercase truncate font-bold tracking-tight\">\r\n            {driver.team}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Team Stripe */}\r\n      <div className={clsx(\"w-1.5 h-8 rounded-full ml-2 flex-shrink-0 opacity-80\", teamColor)} />\r\n\r\n      {/* Remove / Drag */}\r\n      {!locked && (\r\n        <div className=\"flex items-center ml-2 gap-1.5\">\r\n          <button\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n              onRemove(driver.slug);\r\n            }}\r\n            className=\"p-1.5 text-gray-600 hover:text-[#E60000] hover:bg-white/5 rounded-lg transition-all\"\r\n          >\r\n            <X className=\"w-4 h-4\" />\r\n          </button>\r\n          <div\r\n            {...attributes}\r\n            {...listeners}\r\n            className=\"cursor-grab active:cursor-grabbing p-1.5 hover:bg-white/5 rounded-lg text-gray-500 hover:text-white transition-all\"\r\n          >\r\n            <GripVertical className=\"w-5 h-5\" />\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n// ÔöÇÔöÇÔöÇ Main Season Vote Page ÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇ\r\nexport default function SeasonVotePage() {\r\n  const { user, loading: authLoading, refreshUser } = useAuth();\r\n  const router = useRouter();\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [locked, setLocked] = useState(false);\r\n  const [pickedDrivers, setPickedDrivers] = useState<PickedDriver[]>([]);\r\n  const [allDrivers, setAllDrivers] = useState<DriverInfo[]>([]);\r\n  const [saving, setSaving] = useState(false);\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n  const [timeLeft, setTimeLeft] = useState(\"\");\r\n\r\n  const sensors = useSensors(\r\n    useSensor(PointerSensor, { activationConstraint: { distance: 8 } }),\r\n    useSensor(KeyboardSensor, { coordinateGetter: sortableKeyboardCoordinates })\r\n  );\r\n\r\n  // Load data\r\n  useEffect(() => {\r\n    async function loadData() {\r\n      try {\r\n        const [lockStatus, votes, driversData] = await Promise.all([\r\n          isSeasonLocked(),\r\n          getSeasonVotes(),\r\n          getAvailableDrivers(),\r\n        ]);\r\n\r\n        setLocked(lockStatus);\r\n        setAllDrivers(driversData);\r\n        setPickedDrivers(\r\n          votes.map((v) => ({\r\n            slug: v.driverSlug,\r\n            name: v.driverName,\r\n            number: v.driverNumber,\r\n            country: v.driverCountry,\r\n            color: v.driverColor,\r\n            team: v.team,\r\n            position: v.position,\r\n          }))\r\n        );\r\n      } catch (error) {\r\n        console.error(\"Failed to load season data\", error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n\r\n    if (!authLoading && user) {\r\n      loadData();\r\n    }\r\n  }, [authLoading, user]);\r\n\r\n  // Countdown\r\n  useEffect(() => {\r\n    const firstRaceDate = new Date(\"2026-03-08T05:00:00Z\");\r\n    const updateCountdown = () => {\r\n      const now = new Date();\r\n      const diff = firstRaceDate.getTime() - now.getTime();\r\n\r\n      if (diff <= 0) {\r\n        setTimeLeft(\"ZABLOKOWANE\");\r\n        setLocked(true);\r\n        return;\r\n      }\r\n\r\n      const days = Math.floor(diff / (1000 * 60 * 60 * 24));\r\n      const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\r\n      const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));\r\n\r\n      setTimeLeft(`${days}d ${hours}h ${minutes}m`);\r\n    };\r\n\r\n    updateCountdown();\r\n    const interval = setInterval(updateCountdown, 60000);\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  // Redirect if not logged in or is admin\r\n  useEffect(() => {\r\n    if (!authLoading) {\r\n      if (!user) {\r\n        router.push(\"/login\");\r\n      } else if (user.isAdmin) {\r\n        router.push(\"/admin\");\r\n      }\r\n    }\r\n  }, [authLoading, user, router]);\r\n\r\n  // Available drivers = all drivers minus picked ones\r\n  const pickedSlugs = new Set(pickedDrivers.map((d) => d.slug));\r\n  const availableDrivers = allDrivers.filter((d) => !pickedSlugs.has(d.slug));\r\n  const filteredAvailable = searchQuery\r\n    ? availableDrivers.filter(\r\n      (d) =>\r\n        d.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n        d.team.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n        String(d.number).includes(searchQuery)\r\n    )\r\n    : availableDrivers;\r\n\r\n  // ÔöÇÔöÇÔöÇ Add driver ÔöÇÔöÇÔöÇ\r\n  const handleAddDriver = async (driver: DriverInfo) => {\r\n    if (locked || saving) return;\r\n    setSaving(true);\r\n\r\n    const newPosition = pickedDrivers.length + 1;\r\n    const newPicked: PickedDriver = { ...driver, position: newPosition };\r\n    setPickedDrivers((prev) => [...prev, newPicked]);\r\n\r\n    try {\r\n      const result = await addSeasonVote(driver.slug);\r\n      if (result.error) {\r\n        setPickedDrivers((prev) => prev.filter((d) => d.slug !== driver.slug));\r\n        toast.error(result.error);\r\n      } else {\r\n        // Animation success toast\r\n        if (newPosition === 1) toast.success(`MISTRZ: ${driver.name}!`);\r\n      }\r\n    } catch {\r\n      setPickedDrivers((prev) => prev.filter((d) => d.slug !== driver.slug));\r\n      toast.error(\"B┼é─àd podczas dodawania\");\r\n    } finally {\r\n      setSaving(false);\r\n      refreshUser();\r\n    }\r\n  };\r\n\r\n  // ÔöÇÔöÇÔöÇ Remove driver ÔöÇÔöÇÔöÇ\r\n  const handleRemoveDriver = async (slug: string) => {\r\n    if (locked || saving) return;\r\n    setSaving(true);\r\n\r\n    const backup = [...pickedDrivers];\r\n    setPickedDrivers((prev) => {\r\n      const filtered = prev.filter((d) => d.slug !== slug);\r\n      return filtered.map((d, i) => ({ ...d, position: i + 1 }));\r\n    });\r\n\r\n    try {\r\n      const result = await removeSeasonVote(slug);\r\n      if (result.error) {\r\n        setPickedDrivers(backup);\r\n        toast.error(result.error);\r\n      }\r\n    } catch {\r\n      setPickedDrivers(backup);\r\n      toast.error(\"B┼é─àd podczas usuwania\");\r\n    } finally {\r\n      setSaving(false);\r\n      refreshUser();\r\n    }\r\n  };\r\n\r\n  // ÔöÇÔöÇÔöÇ Drag reorder ÔöÇÔöÇÔöÇ\r\n  const handleDragEnd = async (event: DragEndEvent) => {\r\n    if (locked || saving) return;\r\n    const { active, over } = event;\r\n\r\n    if (over && active.id !== over.id) {\r\n      const oldIndex = pickedDrivers.findIndex((d) => d.slug === active.id);\r\n      const newIndex = pickedDrivers.findIndex((d) => d.slug === over.id);\r\n      const newOrder = arrayMove(pickedDrivers, oldIndex, newIndex).map((d, i) => ({\r\n        ...d,\r\n        position: i + 1,\r\n      }));\r\n\r\n      const backup = [...pickedDrivers];\r\n      setPickedDrivers(newOrder);\r\n      setSaving(true);\r\n\r\n      try {\r\n        const result = await reorderSeasonVotes(newOrder.map((d) => d.slug));\r\n        if (result.error) {\r\n          setPickedDrivers(backup);\r\n          toast.error(result.error);\r\n        }\r\n      } catch {\r\n        setPickedDrivers(backup);\r\n        toast.error(\"B┼é─àd podczas zmiany kolejno┼øci\");\r\n      } finally {\r\n        setSaving(false);\r\n      }\r\n    }\r\n  };\r\n\r\n  if (loading || authLoading) {\r\n    return (\r\n      <div className=\"animate-pulse space-y-4 pb-24 pt-8 px-4 h-screen\">\r\n        {[...Array(6)].map((_, i) => (\r\n          <div key={i} className=\"h-16 bg-[#1C1C1E] rounded-2xl w-full\" />\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const progress = (pickedDrivers.length / allDrivers.length) * 100;\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-screen max-h-screen overflow-hidden bg-[#0D0D0D]\">\r\n      {/* Scrollable Area for Added Drivers */}\r\n      <div className=\"flex-1 overflow-y-auto px-4 pt-8 pb-4 space-y-6\">\r\n        {/* Header and Progress */}\r\n        <div className=\"sticky top-0 z-20 bg-[#0D0D0D]/95 backdrop-blur-sm -mx-4 px-4 pb-4 pt-0\">\r\n          <div className=\"flex items-center justify-between mb-2\">\r\n            <div>\r\n              <h1 className=\"text-3xl font-black text-white uppercase tracking-tighter leading-none\">\r\n                MISTRZOSTWA <span className=\"text-[#E60000]\">2026</span>\r\n              </h1>\r\n              <p className=\"text-[10px] text-gray-500 uppercase tracking-[0.2em] mt-1 font-black\">\r\n                Twoje typowanie ko┼äcowe\r\n              </p>\r\n            </div>\r\n            \r\n            <span className={clsx(\r\n              \"text-[10px] font-bold px-2 py-1 rounded-lg border flex items-center gap-1\",\r\n              locked\r\n                ? \"bg-[#E60000]/10 text-[#E60000] border-[#E60000]/20\"\r\n                : \"bg-[#2C2C2E] text-white border-white/10\"\r\n            )}>\r\n              {locked ? <Lock className=\"w-3 h-3\" /> : \"ÔÅ░\"} {timeLeft || \"┼üadowanie...\"}\r\n            </span>\r\n\r\n            {!locked && saving && (\r\n              <div className=\"flex items-center gap-1.5 ml-2\">\r\n                <div className=\"w-1.5 h-1.5 bg-[#E60000] rounded-full animate-pulse shadow-[0_0_8px_#E60000]\" />\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Progress bar */}\r\n          {!locked && (\r\n            <div className=\"h-1 bg-white/5 rounded-full overflow-hidden mt-4\">\r\n              <div\r\n                className=\"h-full bg-gradient-to-r from-[#E60000] to-red-400 transition-all duration-500 shadow-[0_0_10px_rgba(230,0,0,0.4)]\"\r\n                style={{ width: `${progress}%` }}\r\n              />\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* List Section */}\r\n        <div>\r\n          {pickedDrivers.length > 0 ? (\r\n            <div className=\"space-y-4\">\r\n              <DndContext\r\n                sensors={sensors}\r\n                collisionDetection={closestCenter}\r\n                onDragEnd={handleDragEnd}\r\n              >\r\n                <SortableContext\r\n                  items={pickedDrivers.map((d) => d.slug)}\r\n                  strategy={verticalListSortingStrategy}\r\n                >\r\n                  <div className=\"grid grid-cols-1 gap-2\">\r\n                    {pickedDrivers.map((driver, index) => (\r\n                      <SortableDriverItem\r\n                        key={driver.slug}\r\n                        driver={driver}\r\n                        index={index}\r\n                        locked={locked}\r\n                        onRemove={handleRemoveDriver}\r\n                      />\r\n                    ))}\r\n                  </div>\r\n                </SortableContext>\r\n              </DndContext>\r\n\r\n              {/* Empty Slots Indicator */}\r\n              {!locked && pickedDrivers.length < allDrivers.length && (\r\n                <div className=\"space-y-2 opacity-20\">\r\n                  {[...Array(Math.min(3, allDrivers.length - pickedDrivers.length))].map((_, i) => (\r\n                    <div key={i} className=\"flex items-center p-3 rounded-2xl border border-dashed border-white/20 h-16\">\r\n                      <div className=\"w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center mr-3 font-black text-xl text-gray-700\">\r\n                        {pickedDrivers.length + i + 1}\r\n                      </div>\r\n                      <div className=\"h-4 w-24 bg-white/10 rounded-full\" />\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n          ) : (\r\n            <div className=\"py-20 flex flex-col items-center justify-center text-center px-8 border-2 border-dashed border-white/5 rounded-[2rem] bg-white/[0.02]\">\r\n              <Trophy className=\"w-16 h-16 text-white/10 mb-6\" />\r\n              <h2 className=\"text-xl font-bold text-white mb-2 italic uppercase\">Kto zostanie mistrzem?</h2>\r\n              <p className=\"text-sm text-gray-500 leading-relaxed font-medium\">\r\n                Wybierz swojego faworyta z listy poni┼╝ej, aby rozpocz─à─ç typowanie sezonu 2026.\r\n              </p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Available Drivers List ÔÇö Bottom \"Drawer\" */}\r\n      {!locked && (\r\n        availableDrivers.length > 0 ? (\r\n          <div className=\"bg-[#1C1C1E] border-t border-white/10 p-4 pb-8 shadow-2xl z-30\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h2 className=\"text-xs font-black text-gray-500 uppercase tracking-[0.2em]\">\r\n                DOST─ÿPNI KIEROWCY ({availableDrivers.length})\r\n              </h2>\r\n              {availableDrivers.length > 8 && (\r\n                <div className=\"relative\">\r\n                  <input\r\n                    type=\"text\"\r\n                    placeholder=\"Search...\"\r\n                    value={searchQuery}\r\n                    onChange={e => setSearchQuery(e.target.value)}\r\n                    className=\"bg-black/40 border border-white/10 rounded-full px-4 py-1.5 text-xs text-white placeholder-gray-600 focus:outline-none focus:border-[#E60000] w-32 md:w-64 transition-all\"\r\n                  />\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2 max-h-48 overflow-y-auto no-scrollbar scroll-smooth\">\r\n              {filteredAvailable.map((driver) => {\r\n                const teamColor = driver.color?.split(\" \")[0] || \"bg-gray-600\";\r\n                return (\r\n                  <button\r\n                    key={driver.slug}\r\n                    onClick={() => handleAddDriver(driver)}\r\n                    disabled={saving}\r\n                    className={clsx(\r\n                      \"flex items-center gap-3 p-2.5 rounded-xl border border-white/5 bg-white/[0.03] hover:bg-white/[0.08] active:scale-95 transition-all text-left group\",\r\n                      saving && \"opacity-50 pointer-events-none\"\r\n                    )}\r\n                  >\r\n                    <div className={clsx(\"w-1 h-6 rounded-full flex-shrink-0\", teamColor)} />\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <div className=\"font-bold text-sm text-gray-300 group-hover:text-white truncate\">\r\n                        {driver.name}\r\n                      </div>\r\n                      <div className=\"text-[9px] text-gray-600 uppercase font-black truncate\">\r\n                        {driver.team}\r\n                      </div>\r\n                    </div>\r\n                    <Plus className=\"w-3.5 h-3.5 text-gray-700 group-hover:text-[#E60000]\" />\r\n                  </button>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"bg-green-900/10 border-t border-green-500/20 p-6 text-center animate-in fade-in slide-in-from-bottom-5 duration-500\">\r\n            <div className=\"text-green-500 font-black text-xs uppercase tracking-[0.3em] mb-2 flex items-center justify-center gap-2\">\r\n              <Trophy className=\"w-4 h-4\" /> Podium gotowe\r\n            </div>\r\n            <p className=\"text-gray-500 text-[10px] font-bold uppercase tracking-widest leading-loose\">\r\n              Ustawienie sezonowe kompletne.<br />Mo┼╝esz zmienia─ç kolejno┼ø─ç przeci─àgaj─àc.\r\n            </p>\r\n          </div>\r\n        )\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\app\\sw.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'NetworkFirst' is defined but never used.","line":6,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":56,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"NetworkFirst"},"fix":{"range":[253,267],"text":""},"desc":"Remove unused variable \"NetworkFirst\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/// <reference lib=\"webworker\" />\r\n\r\nimport { cleanupOutdatedCaches, precacheAndRoute } from \"workbox-precaching\";\r\nimport { clientsClaim } from \"workbox-core\";\r\nimport { registerRoute } from \"workbox-routing\";\r\nimport { CacheFirst, StaleWhileRevalidate, NetworkFirst } from \"workbox-strategies\";\r\nimport { ExpirationPlugin } from \"workbox-expiration\";\r\n\r\ndeclare const self: ServiceWorkerGlobalScope;\r\n\r\n// Cleanup old caches\r\ncleanupOutdatedCaches();\r\n\r\n// Take control immediately\r\nself.skipWaiting();\r\nclientsClaim();\r\n\r\n// Precache all assets generated by build process\r\nprecacheAndRoute(self.__WB_MANIFEST);\r\n\r\n// Cache images with CacheFirst strategy\r\nregisterRoute(\r\n  ({ request }) => request.destination === \"image\",\r\n  new CacheFirst({\r\n    cacheName: \"images\",\r\n    plugins: [\r\n      new ExpirationPlugin({\r\n        maxEntries: 60,\r\n        maxAgeSeconds: 30 * 24 * 60 * 60, // 30 Days\r\n      }),\r\n    ],\r\n  })\r\n);\r\n\r\n// Cache styles and scripts with StaleWhileRevalidate\r\nregisterRoute(\r\n  ({ request }) =>\r\n    request.destination === \"script\" ||\r\n    request.destination === \"style\",\r\n  new StaleWhileRevalidate({\r\n    cacheName: \"static-resources\",\r\n  })\r\n);\r\n\r\n// Cache Next.js data\r\nregisterRoute(\r\n  ({ url }) => url.pathname.startsWith(\"/_next/data/\"),\r\n  new StaleWhileRevalidate({\r\n    cacheName: \"next-data\",\r\n  })\r\n);\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\components\\ui\\badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\components\\ui\\button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\components\\ui\\scroll-area.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\lib\\data.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\lib\\mockData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\lib\\prisma.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\lib\\scoring.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\lib\\store.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\lib\\testScoring.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tmpAdmin\\AntigravityProjects\\f1-vote\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
